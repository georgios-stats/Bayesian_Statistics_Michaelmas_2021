<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.3.6.1" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>LyX Document</title>
<style type='text/css'>
/* LyX Provided Styles */
mstyle.math { font-style: italic; }

/* Layout-provided Styles */
del.strikeout {
  text-decoration: line-through;
}
div.standard {
	margin-bottom: 2ex;
}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
dl.description dt { font-weight: bold; }
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.solution_ {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.solution__label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
span.flex_url {
font-family: monospace;
}
div.Frameless { margin: 1em; }
div.marginal {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	background-color: #F0F0F0;
	float:right;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}


</style>
</head>
<body dir="auto">




<div class="standard" id='magicparlabel-14'><div class="flex_color_box"><div class="plain_layout" id='magicparlabel-27'>Bayesian Statistics III/IV (MATH3341/4031)&nbsp;&nbsp;Michaelmas term, 2021<div style='height:3ex'></div></div>

<div class="plain_layout" style='text-align: center;' id='magicparlabel-28'> Handout 16: Hierarchical Bayes modeling<div style='height:3ex'></div></div>

<div class="plain_layout" id='magicparlabel-45'>Lecturer &amp; author: Georgios P. Karagiannis <a href="georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class="plain_layout" id='magicparlabel-46'><hr />

</div>
<h3 class="subsection_" id='magicparlabel-47'>Aim</h3>
<div class="plain_layout" id='magicparlabel-48'>To be able to specify and analyze a Hierarchical Bayesian, as well as to extend previously introduces concepts in the Hierarchical Bayes framework.</div>

<div class="plain_layout" id='magicparlabel-49'><hr />

</div>
<h3 class="subsection_" id='magicparlabel-50'>Basic&nbsp;reading&nbsp;list:</h3>

<ul class="itemize" id='magicparlabel-51'><li class="itemize_item">Berger, J. O. (2013; Section 4.6). Statistical decision theory and Bayesian analysis. Springer.</li>
<li class="itemize_item">Robert, C. (2007, Sections 10.1-10.3). The Bayesian choice: from decision-theoretic foundations to computational implementation. Springer Science &amp; Business Media.</li>
<li class="itemize_item">Robert, C. P., &amp; Reber, A. (1998). Bayesian modelling of a pharmaceutical experiment with heterogeneous responses. SankhyƒÅ: The Indian Journal of Statistics, Series B, 145-160. </li>
</ul>
<div class="plain_layout" id='magicparlabel-62'><hr />

</div>
<h3 class="subsection_" id='magicparlabel-63'>R&nbsp;scripts:</h3>

<dl class='description' id='magicparlabel-64'><dt class="description_label">Bayesian&nbsp;Normal&nbsp;Mixture&nbsp;model&nbsp;(Appendix&nbsp;<a href="#sec_Appendix_1">A</a>):</dt>
<dd class="description_item"> <span class="flex_url">http://htmlpreview.github.io/?https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Computer_practical/Normal_Mixture_model/Bayesian_Normal_Mixture_Model.nb.html</span></dd>
<dt class="description_label">Bayesian&nbsp;Variable&nbsp;Selection&nbsp;in&nbsp;Logistic&nbsp;regression&nbsp;model&nbsp;(Appendix&nbsp;<a href="#sec_Appendix_1_1">B</a>):</dt>
<dd class="description_item"> <span class="flex_url">http://htmlpreview.github.io/?https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Computer_practical/Bernoulli_regression_model_variable_selection/Bernoulli_Regression_Model_VS_full.nb.html</span></dd>
<dt class="description_label">Random&nbsp;effect&nbsp;model&nbsp;(Appendix&nbsp;<a href="#sec_Appendix">C</a>):</dt>
<dd class="description_item"> <span class="flex_url">https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Lecture_handouts/Rscripts/Hierarchical_bayes/HierarchicalBayesPharmaceutical.R</span></dd>
</dl>
</div></div>


<div class="standard" id='magicparlabel-87'><br />

</div>
<h2 class="section" id='magicparlabel-88'><span class="section_label">1</span> Hierarchical Bayesian Model</h2>
<div class="standard" id='magicparlabel-89'>A hierarchical Bayesian model involves several levels of conditional distributions. It can be hierarchical due to the sampling distribution modeling or due to the decomposition of the prior information. </div>

<div class="definition" id='magicparlabel-90'><div class="definition_item"><span class="definition_label">Definition 1.</span>
A hierarchical Bayes model is a Bayesian statistical model with sampling distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, where the prior distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is decomposed in conditional distributions. The Bayesian model is <a id="eq_hierarhical_prior_model_2" />

<div style = "text-align: center;"><img src="lyxpreviewtAvkBL1.png" alt="Mathematical Equation" />
</div>
</div>
</div>

<div class="standard" id='magicparlabel-91'><br />

</div>

<div class="remark" id='magicparlabel-92'><div class="remark_item"><span class="remark_label">Remark 2.</span>
The joint distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo><mn>...</mn>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow>
      <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> has pdf<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo><mn>...</mn>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow>
      <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>3</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>...</mn><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow>
      <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>  </div>
</div>

<div class="standard" id='magicparlabel-114'><br />

</div>

<div class="remark" id='magicparlabel-115'><div class="remark_item"><span class="remark_label">Remark 3.</span>
Hierarchical Bayesian model is simply a special type of Bayesian model, where <a id="eq_hierarhical_prior_model_2_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &phi; </mi><mo>|</mo>
        <msub>
         <mrow><mi> &phi; </mi>
         </mrow>
         <mrow><mi>m</mi>
         </mrow>
        </msub>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &phi; </mi><mo>|</mo>
         <msub>
          <mrow><mi> &phi; </mi>
          </mrow>
          <mrow><mi>m</mi>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(2)
   </mtd>
  </mtr>
 </mtable></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &phi; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow>
      <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &phi; </mi>
   </mrow>
   <mrow><mi>m</mi>
   </mrow>
  </msub>
 </mrow></math> fixed hyper-parameter.</div>
</div>

<div class="standard" id='magicparlabel-116'><br />

</div>

<div class="remark" id='magicparlabel-117'><div class="remark_item"><span class="remark_label">Remark 4.</span>
The Bayesian model with sampling distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, can be recovered from <a href="#eq_hierarhical_prior_model_2_1">(2)</a> by marginalizing the prior as<a id="eq_ewtgfasfg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow><mo> &Phi; </mo>
      </mrow>
     </msub><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>z</mi>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow><mo> &Phi; </mo>
      </mrow>
     </msub><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &phi; </mi><mo>|</mo>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &phi; </mi><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mo> &Phi; </mo>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo> &times; </mo>
        <msub>
         <mrow><mo> &Phi; </mo>
         </mrow>
         <mrow>
          <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msub><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &phi; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mn>...</mn><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow>
        <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
        </mrow>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &phi; </mi>
       </mrow>
       <mrow><mi>m</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &phi; </mi>
      </mrow>
      <mrow>
       <mrow><mi>m</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(3)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &phi; </mi>
   </mrow>
   <mrow><mi>m</mi>
   </mrow>
  </msub>
 </mrow></math> is just a fixed hyper-parameter. Hence, hierarchical models are indeed included in the Bayesian paradigm.</div>
</div>

<div class="standard" id='magicparlabel-118'><br />

</div>

<div class="note" id='magicparlabel-119'><div class="note_item"><span class="note_label">Note 5.</span>
A hierarchical Bayesian model can be used as a mean to specify more diverse priors. This is achieved by setting <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &phi; </mi>
 </mrow></math> to be a random hyper-parameter with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &phi; </mi><mo>|</mo>
   <msub>
    <mrow><mi> &phi; </mi>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> instead of setting <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &phi; </mi>
 </mrow></math> to have a fixed value.</div>
</div>

<div class="standard" id='magicparlabel-120'><br />

</div>

<div class="note" id='magicparlabel-121'><div class="note_item"><span class="note_label">Note 6.</span>
A hierarchical Bayesian model can be used when the sampling distribution or the prior distributions justify a certain structure.</div>
</div>

<div class="standard" id='magicparlabel-122'><br />

</div>

<div class="example" id='magicparlabel-123'><div class="example_item"><span class="example_label">Example 7.</span>
<a id="exa_Consider_the_following" />
[Normal mixture model]&nbsp; Consider the following application where our concern is the distribution of enzymatic activity in the blood, for an enzyme involved in the metabolism of carcinogenic substances, among a group of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>=</mo><mn>245</mn>
  </mrow>
 </mrow></math> unrelated individuals; aka cluster analysis.</div>
<div class="example_item"><div class='Frameless' style='width: 50%; '><div class="plain_layout" id='magicparlabel-128'>Our observables are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>n</mi><mo>=</mo><mn>245</mn>
  </mrow>
 </mrow></math>. In the Boxplot on the right, we can clearly see that the distribution is multimodal, suggesting the existence of subpopulations/groups.</div>

<div class="plain_layout" id='magicparlabel-129'>&nbsp;</div>

<div class="plain_layout" id='magicparlabel-130'>Interest lies on identifying subgroups of slow or fast metabolizers as a marker of genetic polymorphism in the general population. As we are interested in learning/identifying the sub-populations as the identity/label of the group from which each observation is drawn is unknown.</div>

<div class="plain_layout" id='magicparlabel-131'>&nbsp;</div>

<div class="plain_layout" id='magicparlabel-132'>Questions of interest:</div>

<ul class="itemize" id='magicparlabel-133'><li class="itemize_item">How many groups exist?</li>
<li class="itemize_item">To which group each observartion belongs?</li>
</ul>
</div><div class='Frameless' style='width: 50%; '><div class="plain_layout" style='text-align: center;' id='magicparlabel-167'><img style='width:30%;' src='0_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_hist-enz.png' alt='image: 0_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_hist-enz.png' />
</div>

<div class="plain_layout" id='magicparlabel-168'>&nbsp;</div>

<div class="plain_layout" id='magicparlabel-169'>Histogram of Enzyme dataset which is available from: <span class="flex_url">https://people.maths.bris.ac.uk/~mapjg/mixdata</span></div>
</div></div>
<div class="standard" id='magicparlabel-174'>As for the sampling model, we can assume that the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>-th observation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is randomly drawn from the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>-th group which has proportion <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &piv; </mi>
   </mrow>
   <mrow><mi>j</mi>
   </mrow>
  </msub>
 </mrow></math> in the population and which is distributed according to the sampling distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-175'>For simplicity, let's assume that all groups are Normally distributed but with different parameter values <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>{
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub>}
  </mrow>
 </mrow></math>; hence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>-th group is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-176'>It is natural to regard the group label <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> for the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th observation as a latent allocation variable: then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is supposed to be distributed as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>}
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is supposed to be distributed as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </msub><mo> &sim; </mo>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
  </mrow>
 </mrow></math>; i.e.<a id="eq_hdswtghwdth" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mtd>
       <mtd>
        <mrow><mo> &sim; </mo>
         <msub>
          <mrow><mi>f</mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>|</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow><mi>z</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow><mi>z</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
       </mtd>
       <mtd>
        <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
     </mtable><mo> &#x27F9; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mtd>
       <mtd>
        <mrow><mo> &sim; </mo>
         <mstyle mathvariant='normal'><mi>N</mi>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>|</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow><mi>z</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow>
            <msub>
             <mrow><mi>z</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
       </mtd>
       <mtd>
        <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
         <msub>
          <mrow><mi> &piv; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mrow>
   </mtd>
   <mtd>(4)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard" id='magicparlabel-177'>To complete the Bayesian model, we specify priors on the unknown quantities: Given there are <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> groups, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>D</mi><mi>i</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &delta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for the group proportions, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &xi; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>/</mo><mi> &kappa; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for the mean, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for the variances. Assume we wish a more spread prior for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mi> &sigma; </mi>
   </mrow>
   <mrow><mi>j</mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msubsup>
 </mrow></math> (for some reason), and hence we specify a hyper-prior on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &beta; </mi>
 </mrow></math> as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &beta; </mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>g</mi><mo>,</mo><mi>h</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. As the number of the groups is unknown, we assign prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>U</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'>
      <mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>c</mi><mi>r</mi>
      </mrow>
     </mstyle>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>,</mo>
    <msub>
     <mrow><mi>k</mi>
     </mrow>
     <mrow><mo> max </mo>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>



<div class="standard" id='magicparlabel-233'><div class='Frameless'><div class="plain_layout" id='magicparlabel-237'><div class='Frameless' style='width: 50%; '><div class="plain_layout" id='magicparlabel-241'><a id="eq_rwghorqewghqrg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow><mi>f</mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &piv; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi> &piv; </mi><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &delta; </mi><mo>,</mo><mn>...</mn><mo>,</mo><mi> &delta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>/</mo><mi> &kappa; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi> &beta; </mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>g</mi><mo>,</mo><mi>h</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow>
          <mstyle mathvariant='normal'><mi>U</mi>
          </mstyle>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>c</mi><mi>r</mi>
           </mrow>
          </mstyle>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>1</mn><mo>,</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(5)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>&nbsp;&nbsp;&nbsp;

<div class='Frameless' style='width: 50%; '><div class="plain_layout" id='magicparlabel-304'>A Directed Acyclic Graph representation of the hierarchical model <a href="#eq_rwghorqewghqrg">(5)</a>. Circles correspond to random quantities. Squares correspond to fixed quantities.</div>
</div></div>
</div></div>

<div class="standard" id='magicparlabel-305'>The joint distribution has pdf <div class="marginal"><div class="plain_layout" id='magicparlabel-317'>Appendix <a href="#sec_Appendix_1">A</a></div>
</div><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo><mi>k</mi><mo>,</mo>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &prod; </mo>
         </mrow>
         <mrow>
          <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msubsup>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
         </mrow>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
         </mrow>
        </mrow>
       </msub><mo>,</mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
       </msub><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &prod; </mo>
         </mrow>
         <mrow>
          <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msubsup>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub>
       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
         </mrow>
        </mrow>
       </msub><mo>|</mo><mi>k</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &piv; </mi>
          </mrow>
          <mrow>
           <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
           </mrow>
          </mrow>
         </msub><mo>|</mo><mi> &delta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &piv; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
       </msub><mo>|</mo><mi>k</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &prod; </mo>
         </mrow>
         <mrow>
          <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>k</mi>
         </mrow>
        </msubsup>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mi>k</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &xi; </mi>
          </mrow>
          <mrow><mi>k</mi>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>/</mo><mi> &kappa; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
       </msub><mo>|</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>,</mo><mi>k</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &prod; </mo>
         </mrow>
         <mrow>
          <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>k</mi>
         </mrow>
        </msubsup>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
         </mrow>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &beta; </mi><mo>|</mo><mi>g</mi><mo>,</mo><mi>h</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &beta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover><mover accent='false'>
     <mover>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow>
         <mrow><mo>|</mo>
          <msub>
           <mrow><mi>k</mi>
           </mrow>
           <mrow><mo> max </mo>
           </mrow>
          </msub><mo>|</mo>
         </mrow>
        </mrow>
       </mfrac>
      </mrow><mo stretchy="true">&OverBrace;</mo>
     </mover>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></mover>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard" id='magicparlabel-318'>The joint posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>,</mo><mi>z</mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be computed with the Bayesian theorem, and factorized as <a id="eq_yhjgksdgfhdsh" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo>,</mo><mi> &beta; </mi><mo>,</mo><mi>z</mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>z</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(6)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>k</mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(7)
   </mtd>
  </mtr>
 </mtable></math> where to infer the number of groups from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>k</mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, the proportions in each group from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, the moments of each group from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, and the allocation of each observation to each group with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-319'>As the required integrals are intractable, we can resolve to numerical methods, etc... Monte Carlo e.g. via JAGS....</div>
</div>



<div class="standard" id='magicparlabel-321'><br />

</div>

<div class="note" id='magicparlabel-322'><div class="note_item"><span class="note_label">Note 8.</span>
<a id="A_particularly_appealing" />
A particularly appealing aspect of hierarchical models is that they allow for conditioning on all levels, and this easy decomposition of the posterior. Consider the Bayesian hierarchical model <a href="#eq_hierarhical_prior_model_2_1">(2)</a> a parametric model <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with a hierarchical prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo>
   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &phi; </mi><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &phi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. The posterior distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> is <a id="eq_Hierarchical_decomposition" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow><mo> &Phi; </mo>
      </mrow>
     </msub><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &phi; </mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &phi; </mi>
    </mrow>
   </mtd>
   <mtd>(8)
   </mtd>
  </mtr>
 </mtable></math> where<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <msub>
         <mrow><mi> &pi; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>f</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &phi; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &phi; </mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>f</mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &phi; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <msub>
         <mrow><mi> &pi; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &phi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac><mo>;</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow><mo> &Theta; </mo>
      </mrow>
     </msub><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi> &pi; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>y</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow><mo> &Theta; </mo>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &phi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msub>
      <mrow><mi> &pi; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &phi; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &phi; </mi>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math>
<br />

</div>
</div>

<div class="remark" id='magicparlabel-323'><div class="remark_item"><span class="remark_label">Remark 9.</span>
Note <a href="#A_particularly_appealing">8</a> has important consequences in terms of the computation of Bayes estimators, since it shows that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be simulated by generating, first, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &phi; </mi>
 </mrow></math> from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, if these two conditional distributions are easier to work with. (Snapshot from Term 2).</div>
</div>

<div class="standard" id='magicparlabel-324'><br />

</div>

<div class="note" id='magicparlabel-325'><div class="note_item"><span class="note_label">Note 10.</span>
<a id="Hierarchical_decomposition_" />
Hierarchical decomposition <a href="#eq_hierarhical_prior_model_2_1">(2)</a> may facilitate the computation of intractable posterior moments. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>h</mi>
 </mrow></math> be a function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>h</mi><mo>:</mo><mo> &Theta; </mo><mo> &rarr; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math>, then<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow>
      <mstyle mathvariant='normal'><mi>E</mi>
      </mstyle>
     </mrow>
     <mrow><mi> &pi; </mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
  </mrow>
 </mrow></math> If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi> &theta; </mi>
  </mrow>
 </mrow></math> is intractable and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> has high dimensionality, one could possibly try to specify the prior decomposition <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mo> &int; </mo>
    </mrow>
    <mrow><mo> &Phi; </mo>
    </mrow>
   </msub>
   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msub>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi> &phi; </mi>
  </mrow>
 </mrow></math> in <a href="#eq_ewtgfasfg">(3)</a> such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be computed analytically, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &phi; </mi>
 </mrow></math> has low dimensionality. In that case one would have to compute the equivalent but lower dimensional (and hence easier) integral <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow>
      <mstyle mathvariant='normal'><mi>E</mi>
      </mstyle>
     </mrow>
     <mrow><mi> &pi; </mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo>
   <msub>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle>
    </mrow>
    <mrow><mi> &pi; </mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>h</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>y</mi><mo>,</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi> &phi; </mi>
  </mrow>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-330'><br />

</div>

<div class="example" id='magicparlabel-331'><div class="example_item"><span class="example_label">Example 11.</span>
<a id="exa__Cont__Example__" />
(Cont. Example <a href="#exa_Consider_the_following">7</a>) From another point of view, recall that the compound distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>k</mi><mo>,</mo>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <a href="#eq_hdswtghwdth">(4)</a> is mixture model of distribution <a id="eq_rjuoghdfajig" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo>|</mo><mi>k</mi><mo>,</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
       </mrow>
      </mrow>
     </msub><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>k</mi><mo>,</mo>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mspace /><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &piv; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace /><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &piv; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
    </mrow>
   </mtd>
   <mtd>(9)
   </mtd>
  </mtr>
 </mtable></math>is a suitable sampling distribution for modeling heterogeneous populations.  Then by marginalizing, we can get the equivalent model<a id="eq_rfkgjgjdrfag" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
        <msubsup>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow>
          <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>k</mi>
         </mrow>
        </msubsup>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="6px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &piv; </mi><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &delta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>a</mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi> &beta; </mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>g</mi><mo>,</mo><mi>h</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi>k</mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow>
          <mstyle mathvariant='normal'><mi>U</mi>
          </mstyle>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>c</mi><mi>r</mi>
           </mrow>
          </mstyle>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>1</mn><mo>,</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(10)
   </mtd>
  </mtr>
 </mtable></math> The joint distribution that admits pdf <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &piv; </mi><mo>|</mo><mi>k</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &mu; </mi><mo>|</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>,</mo><mi>k</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>|</mo><mi>k</mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &beta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
  </mrow>
 </mrow></math>The posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> can be computed with the Bayesian theorem, and factorized as <a id="eq_thdahdghjrfhjdgh" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup><mo>,</mo><mi> &beta; </mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
         <msup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(11)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>|</mo><mi>y</mi><mo>,</mo><mi>k</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>k</mi><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(12)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>
<div class="standard" id='magicparlabel-364'>Models <a href="#eq_rwghorqewghqrg">(5)</a> and <a href="#eq_rfkgjgjdrfag">(10)</a> are the same model in the sense that posterior <a href="#eq_thdahdghjrfhjdgh">(12)</a> is the marginal of the posterior <a href="#eq_yhjgksdgfhdsh">(7)</a>.</div>


<div class="standard" id='magicparlabel-369'><br />

</div>

<div class="example" id='magicparlabel-370'><div class="example_item"><span class="example_label">Example 12.</span>
<a id="exa_Consider_the__Challenger" />
[Variable selection in logistic regression] Consider the 'Challenger O-ring' example from the Computer practicals. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> denote the presence of a defective O-ring in the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th flight (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>0</mn>
 </mrow></math> for absence, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>1</mn>
 </mrow></math> for presence). <div class="marginal"><div class="plain_layout" id='magicparlabel-374'>Appendix <a href="#sec_Appendix_1_1">B</a></div>
</div></div>
<div class="standard" id='magicparlabel-375'>Assume that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> can be modeled as observations generated independently from a Bernoulli distribution with parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>p</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>. Here, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>p</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> denotes the relative frequency of defective O-rings at flight <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>. We study if 'presence of a defective O-ring' (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math>) depends on the 'temperature' (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>t</mi>
 </mrow></math>), or the 'pressure' (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>s</mi>
 </mrow></math>).</div>

<div class="standard" id='magicparlabel-376'>Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>t</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> denote the temperature (in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &deg; </mi>
 </mrow></math>F) in the platform, and let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>s</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> denote the Leak check pressure (in PSI) before the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th flight. Here are some possible models of interest: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msup><mo>:</mo><mspace width="10px" /><mspace width="10px" /><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>;</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>M</mi>
         </mrow>
         <mrow><mi>I</mi>
         </mrow>
        </msup>
       </mrow>
      </msub><mo>,</mo>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow><mi>I</mi>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
   <mtd>
    <mrow><mo>;</mo>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow>
       <mrow><mi>I</mi><mi>V</mi>
       </mrow>
      </mrow>
     </msup><mo>:</mo><mspace width="10px" /><mspace width="10px" /><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>;</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>M</mi>
         </mrow>
         <mrow>
          <mrow><mi>I</mi><mi>V</mi>
          </mrow>
         </mrow>
        </msup>
       </mrow>
      </msub><mo>,</mo>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow>
        <mrow><mi>I</mi><mi>V</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow>
       <mrow><mi>I</mi><mi>I</mi>
       </mrow>
      </mrow>
     </msup><mo>:</mo><mspace width="10px" /><mspace width="10px" /><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>;</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>M</mi>
         </mrow>
         <mrow>
          <mrow><mi>I</mi><mi>I</mi>
          </mrow>
         </mrow>
        </msup>
       </mrow>
      </msub><mo>,</mo>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow>
        <mrow><mi>I</mi><mi>I</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
   <mtd>
    <mrow><mo>;</mo>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow><mi>V</mi>
      </mrow>
     </msup><mo>:</mo><mspace width="10px" /><mspace width="10px" /><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>;</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>M</mi>
         </mrow>
         <mrow><mi>V</mi>
         </mrow>
        </msup>
       </mrow>
      </msub><mo>,</mo>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow><mi>V</mi>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>3</mn>
         </mrow>
        </msub><mi>t</mi><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mi>t</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>3</mn>
         </mrow>
        </msub><mi>t</mi><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow>
       <mrow><mi>I</mi><mi>I</mi><mi>I</mi>
       </mrow>
      </mrow>
     </msup><mo>:</mo><mspace width="10px" /><mspace width="10px" /><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>;</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>M</mi>
         </mrow>
         <mrow>
          <mrow><mi>I</mi><mi>I</mi><mi>I</mi>
          </mrow>
         </mrow>
        </msup>
       </mrow>
      </msub><mo>,</mo>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow>
        <mrow><mi>I</mi><mi>I</mi><mi>I</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mfrac>
     <mrow>
      <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>0</mn>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mi>s</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mrow>
    </mfrac>
   </mtd>
   <mtd>
    <mstyle mathvariant='normal'>
     <mrow><mi>e</mi><mi>t</mi><mi>c</mi><mn>...</mn>
     </mrow>
    </mstyle>
   </mtd>
   <mtd><mrow/>
   </mtd>
  </mtr>
 </mtable></math>The&nbsp;Bayesian&nbsp;hierarchical&nbsp;model under consideration is: <a id="eq_xfvgadgdfasg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi> &theta; </mi><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>:</mo><mo>:</mo>
       </mrow>
      </mtd>
      <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
       <mtable>
        <mtr>
         <mtd>
          <mrow>
           <msub>
            <mrow><mi>y</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub><mo>|</mo><mi>M</mi><mo>,</mo>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>M</mi>
            </mrow>
           </msub><mo> &sim; </mo>
           <mstyle mathvariant='normal'>
            <mrow><mi>B</mi><mi>r</mi>
            </mrow>
           </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

            <msub>
             <mrow><mi>y</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

            <mfrac>
             <mrow>
              <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

               <mrow>
                <msubsup>
                 <mrow><mi>x</mi>
                 </mrow>
                 <mrow>
                  <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
                  </mrow>
                 </mrow>
                 <mrow><mi> &top; </mi>
                 </mrow>
                </msubsup>
                <msub>
                 <mrow><mi> &beta; </mi>
                 </mrow>
                 <mrow><mi>M</mi>
                 </mrow>
                </msub>
               </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

              </mrow>
             </mrow>
             <mrow>
              <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

               <mrow>
                <msubsup>
                 <mrow><mi>x</mi>
                 </mrow>
                 <mrow>
                  <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
                  </mrow>
                 </mrow>
                 <mrow><mi> &top; </mi>
                 </mrow>
                </msubsup>
                <msub>
                 <mrow><mi> &beta; </mi>
                 </mrow>
                 <mrow><mi>M</mi>
                 </mrow>
                </msub>
               </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

              </mrow>
             </mrow>
            </mfrac>
           </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace />
           <msubsup>
            <mrow><mi>x</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
             </mrow>
            </mrow>
            <mrow><mi> &top; </mi>
            </mrow>
           </msubsup>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>M</mi>
            </mrow>
           </msub><mo>=</mo>
           <msub>
            <mrow><mo> &sum; </mo>
            </mrow>
            <mrow>
             <mrow><mi>j</mi><mo> &isin; </mo><mi>M</mi>
             </mrow>
            </mrow>
           </msub>
           <msubsup>
            <mrow><mi>x</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
             </mrow>
            </mrow>
            <mrow><mi> &top; </mi>
            </mrow>
           </msubsup>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>j</mi>
            </mrow>
           </msub><mspace width="20px" />
           <mstyle mathvariant='normal'>
            <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;
            </mrow>
           </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
          </mrow>
         </mtd>
         <mtd><mrow/>
         </mtd>
        </mtr>
       </mtable>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &theta; </mi><mo>|</mo>
        <msub>
         <mrow><mi> &phi; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &theta; </mi><mo>|</mo>
         <msub>
          <mrow><mi> &phi; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>:</mo><mo>:</mo>
       </mrow>
      </mtd>
      <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
       <mtable>
        <mtr>
         <mtd>
          <mrow>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>j</mi>
            </mrow>
           </msub><mo>|</mo><mi>M</mi><mo> &sim; </mo>
           <mstyle mathvariant='normal'><mi>N</mi>
           </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mrow>
            <msub>
             <mrow><mi> &beta; </mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub><mo>|</mo>
            <msub>
             <mrow><mi> &mu; </mi>
             </mrow>
             <mrow><mn>0</mn>
             </mrow>
            </msub><mo>,</mo>
            <msubsup>
             <mrow><mi> &sigma; </mi>
             </mrow>
             <mrow><mn>0</mn>
             </mrow>
             <mrow><mn>2</mn>
             </mrow>
            </msubsup>
           </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="10px" /><mspace width="10px" />
           <mstyle mathvariant='normal'>
            <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>a</mi><mi>l</mi><mi>l</mi>
            </mrow>
           </mstyle><mspace /><mi>j</mi><mo> &isin; </mo><mi>M</mi>
          </mrow>
         </mtd>
         <mtd><mrow/>
         </mtd>
        </mtr>
        <mtr>
         <mtd><mrow/>
         </mtd>
         <mtd><mrow/>
         </mtd>
        </mtr>
        <mtr>
         <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
          <mtable>
           <mtr>
            <mtd><mi>M</mi>
            </mtd>
            <mtd>
             <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

              <mrow><mi>j</mi><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>}<mo>,</mo><mspace width="6px" />
               <mstyle mathvariant='normal'>
                <mrow><mi>s</mi><mn>.</mn><mi>t</mi><mn>.</mn>
                </mrow>
               </mstyle><mspace width="6px" />
               <msub>
                <mrow><mi> &gamma; </mi>
                </mrow>
                <mrow><mi>j</mi>
                </mrow>
               </msub><mo>=</mo><mn>1</mn>
              </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mrow>
              <msub>
               <mrow><mi> &gamma; </mi>
               </mrow>
               <mrow><mi>j</mi>
               </mrow>
              </msub><mo>|</mo><mi> &piv; </mi>
             </mrow>
            </mtd>
            <mtd>
             <mrow><mo> &sim; </mo>
              <mstyle mathvariant='normal'>
               <mrow><mi>B</mi><mi>r</mi>
               </mrow>
              </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &piv; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="10px" /><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
         </mtd>
         <mtd><mrow/>
         </mtd>
        </mtr>
        <mtr>
         <mtd><mrow/>
         </mtd>
         <mtd><mrow/>
         </mtd>
        </mtr>
       </mtable>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi> &phi; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo>|</mo>
        <msub>
         <mrow><mi> &phi; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &phi; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &phi; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>:</mo>
       </mrow>
      </mtd>
      <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
       <mtable>
        <mtr>
         <mtd><mi> &piv; </mi>
         </mtd>
         <mtd>
          <mrow><mo> &sim; </mo>
           <mstyle mathvariant='normal'>
            <mrow><mi>B</mi><mi>e</mi>
            </mrow>
           </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mrow>
            <msub>
             <mrow><mi>a</mi>
             </mrow>
             <mrow><mn>0</mn>
             </mrow>
            </msub><mo>,</mo>
            <msub>
             <mrow><mi>b</mi>
             </mrow>
             <mrow><mn>0</mn>
             </mrow>
            </msub>
           </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(13)
   </mtd>
  </mtr>
 </mtable></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>M</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &phi; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo>=</mo><mi> &piv; </mi>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &phi; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>a</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi>b</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Above, in the prior we considered an extra level of uncertainty by considering <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &piv; </mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>B</mi><mi>e</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>a</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi>b</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> .</div>

<div class="standard" id='magicparlabel-393'>Here we added an additional level of uncertainty, and set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &piv; </mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>B</mi><mi>e</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>a</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi>b</mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> which creates a more diverse prior model, compared to the computer practical handout example where we had set <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &piv; </mi><mo>=</mo><mn>0.5</mn>
  </mrow>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-394'>Now the joint probability distribution has pdf<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><munder accent='false'>
   <munder>
    <mrow>
     <mrow>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>r</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

       <mfrac>
        <mrow>
         <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msubsup>
            <mrow><mi>x</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
             </mrow>
            </mrow>
            <mrow><mi> &top; </mi>
            </mrow>
           </msubsup>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>M</mi>
            </mrow>
           </msub>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msubsup>
            <mrow><mi>x</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
             </mrow>
            </mrow>
            <mrow><mi> &top; </mi>
            </mrow>
           </msubsup>
           <msub>
            <mrow><mi> &beta; </mi>
            </mrow>
            <mrow><mi>M</mi>
            </mrow>
           </msub>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&UnderBrace;</mo>
   </munder>
   <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow></munder><munder accent='false'>
   <munder>
    <mrow>
     <mrow>
      <msub>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo> &isin; </mo><mi>M</mi>
        </mrow>
       </mrow>
      </msub>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>d</mi>
       </mrow>
      </msubsup>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>r</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &gamma; </mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>|</mo><mi> &piv; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&UnderBrace;</mo>
   </munder>
   <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi> &theta; </mi><mo>|</mo>
     <msub>
      <mrow><mi> &phi; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow></munder><munder accent='false'>
   <munder>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>e</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &piv; </mi><mo>|</mo>
       <msub>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub><mo>,</mo>
       <msub>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&UnderBrace;</mo>
   </munder>
   <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &phi; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>|</mo>
     <msub>
      <mrow><mi> &phi; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow></munder>
  </mrow>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-399'><br />

</div>

<div class="example" id='magicparlabel-400'><div class="example_item"><span class="example_label">Example 13.</span>
<a id="exa_Robert_and_Reber" />
Robert and Reber (1998) considers an experiment under which rats are intoxicated by a substance, then treated by either a placebo or a drug. (See: <span class="flex_url">https://www.jstor.org/stable/pdf/25053027.pdf</span>)<div class="marginal"><div class="plain_layout" id='magicparlabel-408'>Appendix <a href="#sec_Appendix">C</a></div>
</div></div>
<div class="standard" id='magicparlabel-409'><b>Statistical&nbsp;model&nbsp;(<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>): </b>The model associated with this experiment is a linear additive model effect: given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>x</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> , <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>th responses of the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th rat at the control, intoxication and treatment stages, respectively. The statistical model was specified such as that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mn>1</mn><mo> &le; </mo><mi>i</mi><mo> &le; </mo><mi>I</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi>x</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
      </mrow>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>c</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>,</mo><mn>1</mn><mo> &le; </mo><mi>j</mi><mo> &le; </mo>
     <msubsup>
      <mrow><mi>J</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>c</mi>
      </mrow>
     </msubsup>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
      </mrow>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>+</mo>
      <msub>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>,</mo><mn>1</mn><mo> &le; </mo><mi>j</mi><mo> &le; </mo>
     <msubsup>
      <mrow><mi>J</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>a</mi>
      </mrow>
     </msubsup><mo>,</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
      </mrow>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>+</mo>
      <msub>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>+</mo>
      <msub>
       <mrow><mi> &xi; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>,</mo><mn>1</mn><mo> &le; </mo><mi>j</mi><mo> &le; </mo>
     <msubsup>
      <mrow><mi>J</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msubsup><mo>,</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is the average control measurement, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &delta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> the average intoxication effect and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &xi; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> the average treatment effect for the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th rat, the variances of these measurements being constant for the control, the intoxication and the treatment effects. An additional (observed) variable is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>w</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>, which is equal to 1 if the rat is treated with the drug, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>0</mn>
 </mrow></math> otherwise.</div>

<div class="standard" id='magicparlabel-410'><b>Prior&nbsp;model&nbsp;<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi> &phi; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>: </b>The different individual averages are related through a common (conjugate) prior distribution, <a id="eq_drasgfdafg" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
    <msub>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
    <msub>
     <mrow><mi> &xi; </mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo>|</mo>
     <msub>
      <mrow><mi>w</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo> &sim; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <mstyle mathvariant='normal'><mi>N</mi>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi>P</mi>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>P</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
       <mtd>
        <mrow><mo>,</mo><mspace width="6px" />
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>=</mo><mn>0</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mstyle mathvariant='normal'><mi>N</mi>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi>D</mi>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>D</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
       <mtd>
        <mrow><mo>,</mo><mspace width="6px" />
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>=</mo><mn>1</mn>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msub>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>c</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>c</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi>c</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
    <msub>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>a</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>a</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi>a</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
    <msub>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
    </msub>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(14)
   </mtd>
  </mtr>
 </mtable></math>This modeling seems to describe the natural phenomenon realistically enough, in the sense of the responses <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>x</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> , <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-411'><b>Hyper-priors&nbsp;<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>:</b> For the higher levels of prior ( <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &phi; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &phi; </mi>
     </mrow>
     <mrow><mi>m</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> in Eq <a href="#eq_hierarhical_prior_model_2_1">2</a>), they considered improper (Jeffrey's) hyper-priors. <a id="eq_dfagdfasg" />
<a id="eq_dsgxdgdsgf" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi> &theta; </mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi> &delta; </mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &delta; </mi>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi> &delta; </mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>P</mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>P</mi>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>P</mi>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>P</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi>P</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>(15)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>D</mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>D</mi>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>D</mi>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>D</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <msub>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mi>D</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac><mn>.</mn>
    </mrow>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd><mrow/>
   </mtd>
   <mtd>(16)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard" id='magicparlabel-412'>The priors in lines <a href="#eq_drasgfdafg">(14)</a>, <a href="#eq_dfagdfasg">(16)</a> and <a href="#eq_dsgxdgdsgf">(16)</a> are improper non-informative priors. One could have have specify proper priors, like Normal-Inverse Gamma which are conjugate, however in that case he/she should have to specify the values for the fixed hyper-parameters.</div>


</div>

<div class="standard" id='magicparlabel-423'><br />

</div>
<h2 class="section" id='magicparlabel-424'><span class="section_label">2</span> Non-identifiability issue </h2>

<div class="definition" id='magicparlabel-425'><div class="definition_item"><span class="definition_label">Definition 14.</span>
A parametric model for which an element of the parametrisation is redundant is said to be non-identified. </div>
</div>

<div class="remark" id='magicparlabel-426'><div class="remark_item"><span class="remark_label">Remark 15.</span>
Let Bayesian model <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msub>
    <mrow><mo> &Theta; </mo>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo> &times; </mo>
   <msub>
    <mrow><mo> &Theta; </mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, and assume that the parametric model does not depend on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>; i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Because the likelihood does not depend on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> suggests that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> does not provide information about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> directly. </div>
</div>

<div class="standard" id='magicparlabel-427'><br />

</div>

<div class="remark" id='magicparlabel-428'><div class="remark_item"><span class="remark_label">Remark 16.</span>
Bayesian analysis of a non-identified model is always possible if a suitable prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Pi; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> on all the parameters is specified. For instance, if one specifies a priori that learning the value of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math> may change his belief about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>, via <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ne; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </div>
<div class="standard" id='magicparlabel-429'>Factorize the prior distribution as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Then, we have the following PDF/PMF<a id="eq_asdasd" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &vprop; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &#x27F9; </mo>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &#x27F9; </mo>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mo> &int; </mo>
         </mrow>
         <mrow>
          <msub>
           <mrow><mo> &Theta; </mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msub>
         </mrow>
        </msub><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle>
        <msub>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </mfrac><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mn>.</mn>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(17)
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <msub>
      <mrow><mo> &int; </mo>
      </mrow>
      <mrow>
       <msub>
        <mrow><mo> &Theta; </mo>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub>
      </mrow>
     </msub><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>y</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(18)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard" id='magicparlabel-430'><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> is non-identifiable parameter from the data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math>, because <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> provides <u>no direct information</u> about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>. Inference about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> based on marginal posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> depends on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> but the information provided about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> comes indirectly through the marginal posterior of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math>, see <a href="#eq_asdasd">(18)</a>. Equivalently, <a href="#eq_asdasd">(18)</a> implies that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> provides no information about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math>. </div>

<div class="standard" id='magicparlabel-431'>If we <u>a priori</u> specify that learning the value of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math> does not change our belief about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, then <a href="#eq_asdasd">(18)</a> becomes <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and hence data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> provide no information about <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> at all.</div>
</div>

<div class="example" id='magicparlabel-440'><div class="example_item"><span class="example_label">Example 17.</span>
(Cont Example <a href="#exa__Cont__Example__">11</a>)  It is not difficult to understand that the Bayesian model as defined in Example <a href="#exa_Consider_the_following">7</a> is non-identifiable. For simplicity we focus on the Bayesian mixture of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>k</mi><mo>=</mo><mn>2</mn>
  </mrow>
 </mrow></math> components with<div class="marginal"><div class="plain_layout" id='magicparlabel-452'>Appendix <a href="#sec_Appendix_1">A</a></div>
</div><a id="eq_rgrqetgrqet" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>y</mi><mo>|</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
     <msup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
     <msub>
      <mrow><mi> &piv; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msub>
      <mrow><mi> &piv; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><munder accent='false'>
     <munder>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&UnderBrace;</mo>
     </munder>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &mu; </mi><mo>|</mo>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></munder><munder accent='false'>
     <munder>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&UnderBrace;</mo>
     </munder>
     <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow></munder>
     <mstyle mathvariant='normal'>
      <mrow><mi>D</mi><mi>i</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &piv; </mi><mo>|</mo><mi> &delta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(19)
   </mtd>
  </mtr>
 </mtable></math>which leads to a posterior such as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

   <mrow>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub>
    <mstyle mathvariant='normal'><mi>N</mi>
    </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>y</mi><mo>|</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
    <mstyle mathvariant='normal'><mi>N</mi>
    </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>y</mi><mo>|</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>G</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>G</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>D</mi><mi>i</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &piv; </mi><mo>|</mo><mi> &delta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>Here the parametrization is non-identifiable because the symmetry in the sampling distribution <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>and the naive prior in <a href="#eq_rgrqetgrqet">(19)</a> produce a posterior such that<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &piv; </mi><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>,</mo><mi> &mu; </mi><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &piv; </mi><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>,</mo><mi> &mu; </mi><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup><mo>=</mo><mo fence='true' stretchy='true' form='prefix'>(</mo><mfrac linethickness='0'>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup></mfrac><mo fence='true' stretchy='true' form='postfix'>)</mo><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>This parametrization is not meaningful for parametric inference. In Bayesian stats this can be resolved for instance by changing the prior and imposing an identifiability constrain as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &pi; </mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &mu; </mi><mo>|</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mn>1</mn>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo> &le; </mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> &int; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mn>1</mn>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo> &le; </mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo>,</mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac><mo> &vprop; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &mu; </mi><mo>|</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mn>1</mn>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo> &le; </mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
<div class="example_item">The non-identifiable model produces marginal posterior in Figures <a href="#fig_Marginal_posterior_2">a</a> and <a href="#fig_Marginal_posterior_3">b</a>.</div>
</div>
<div class="standard" id='magicparlabel-458'><div class='Frameless'><div class="plain_layout" id='magicparlabel-462'><div class='Frameless' style='width: 50%; '><div class="plain_layout" id='magicparlabel-466'><a id="eq_dfahdashdahdtae" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi> &piv; </mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &delta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &mu; </mi><mo>|</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(20)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>&nbsp;&nbsp;&nbsp;
<div class='Frameless' style='width: 50%; '>
<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-486'><img style='width:22%;' src='1_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____istics_III_IV_Handouts_figures_non-ident-m1.png' alt='image: 1_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____istics_III_IV_Handouts_figures_non-ident-m1.png' />
</div>

<div class="plain_layout" id='magicparlabel-487'><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  Marginal posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math><a id="fig_Marginal_posterior_2" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-495'><img style='width:22%;' src='2_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____istics_III_IV_Handouts_figures_non-ident-m2.png' alt='image: 2_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____istics_III_IV_Handouts_figures_non-ident-m2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  Marginal posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math><a id="fig_Marginal_posterior_3" />
</span></div>
</div>



</div>

</div></div>
</div> </div>

<div class="standard" id='magicparlabel-509'>After non-identifiability is resolved, the identifiable model produces marginal posterior in Figures <a href="#fig_Marginal_posterior">c</a> and <a href="#fig_Marginal_posterior_1">d</a>.</div>

<div class="standard" id='magicparlabel-510'><div class='Frameless'><div class="plain_layout" id='magicparlabel-514'><div class='Frameless' style='width: 50%; '><div class="plain_layout" id='magicparlabel-518'><a id="eq_dfahdashdahdtae_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mi> &piv; </mi>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &delta; </mi><mo>,</mo><mn>...</mn><mo>,</mo><mi> &delta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mi> &mu; </mi><mo>|</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mn>1</mn>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo> &le; </mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <msup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(21)
   </mtd>
  </mtr>
 </mtable></math></div>
</div>&nbsp;&nbsp;&nbsp;&nbsp;
<div class='Frameless' style='width: 50%; '>
<div class='float-figure'><div class='float-figure'><div class="plain_layout" id='magicparlabel-538'><img style='width:22%;' src='3_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_ident-m1.png' alt='image: 3_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_ident-m1.png' />
</div>

<div class="plain_layout" id='magicparlabel-539'><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  Marginal posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math><a id="fig_Marginal_posterior" />
</span></div>
</div>
<div class='float-figure'><div class="plain_layout" id='magicparlabel-547'><img style='width:22%;' src='4_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_ident-m2.png' alt='image: 4_extra_tmp_mffk55_Dropbox_Teaching_2021_term1____statistics_III_IV_Handouts_figures_ident-m2.png' />
<span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  Marginal posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math><a id="fig_Marginal_posterior_1" />
</span></div>
</div>

</div>

</div> </div>
</div></div>


<div class="standard" id='magicparlabel-560'><br />

</div>
<h2 class="section" id='magicparlabel-561'><span class="section_label">3</span> Augmentation </h2>

<div class="definition" id='magicparlabel-562'><div class="definition_item"><span class="definition_label">Definition 18.</span>
<a id="def_Augmentation_technique_on" />
Augmentation technique on a Bayesian model <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>y</mi><mo> &sim; </mo><mi>F</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="6px" /><mo>,</mo><mspace width="6px" /><mi> &theta; </mi><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is when the vector <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is imputed by auxiliary random quantities <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo> &sim; </mo><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where the distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is such that the joint distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo><mi>x</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> admits the joint distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> as its marginal, e.g. <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi>x</mi>
  </mrow>
 </mrow></math></div>
</div>

<div class="remark" id='magicparlabel-563'><div class="remark_item"><span class="remark_label">Remark 19.</span>
According to Definition <a href="#def_Augmentation_technique_on">18</a>, the posterior of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> given the observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> remains the same; e.g.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>,</mo><mi>x</mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi>x</mi><mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo><mi>x</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi>x</mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>,</mo><mi>x</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi> &theta; </mi>
      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi>x</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>
</div>

<div class="example" id='magicparlabel-564'><div class="example_item"><span class="example_label">Example 20.</span>
(Cont. Examples <a href="#exa_Consider_the_following">7</a> and <a href="#exa__Cont__Example__">11</a>) Imputation of the hierarchical model <a href="#eq_rfkgjgjdrfag">(10)</a> by considering the latent variables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>}
  </mrow>
 </mrow></math> leads to the augmented hierarchical model <a href="#eq_rwghorqewghqrg">(5)</a>.</div>
</div>

<div class="remark" id='magicparlabel-565'><div class="remark_item"><span class="remark_label">Remark 21.</span>
Software JAGS, aiming at facilitating Bayesian computations, requires as inputs only Bayesian hierarchical models where the dimension of the unknown quantities is fixed (not random). Consequently many hierarchical models for model comparison such as <a href="#eq_rwghorqewghqrg">(5)</a>, <a href="#eq_rfkgjgjdrfag">(10)</a>, and <a href="#eq_xfvgadgdfasg">13</a> cannot be used directly. This limitation can be addressed via augmentation, i.e. the imputation of the hierarchical model with suitable random variables such that the resulting joint posterior distribution admits the posterior distribution as its marginal.</div>
</div>

<div class="example" id='magicparlabel-566'><div class="example_item"><span class="example_label">Example 22.</span>
(Cont Example <a href="#exa_Consider_the__Challenger">12</a>) Notice that the length of the join unknown parameter vector <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>M</mi><mo>,</mo>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>M</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &gamma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi> &piv; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is not fixed but random because <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>M</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi>j</mi><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>}<mo>,</mo><mspace width="6px" />
    <mstyle mathvariant='normal'>
     <mrow><mi>s</mi><mn>.</mn><mi>t</mi><mn>.</mn>
     </mrow>
    </mstyle><mspace width="6px" />
    <msub>
     <mrow><mi> &gamma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>=</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> is random/unknown. Current versions of JAGS work only when the join unknown parameter vector of the Bayesian hierarchical model is fixed. Augent the hierarchical model properly so that it can be used with RJAGS. </div>

<div class="solution_" id='magicparlabel-567'><div class="solution__item"><span class="solution__label">Solution.</span>
We augment model <a href="#eq_xfvgadgdfasg">(13)</a> with auxiliary random quantities such that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo>|</mo><mi>M</mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="10px" /><mspace width="10px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>a</mi><mi>l</mi><mi>l</mi>
    </mrow>
   </mstyle><mspace /><mi>j</mi><mo> &notin; </mo><mi>M</mi>
  </mrow>
 </mrow></math>, i.e.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
  <mtable>
   <mtr>
    <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo><mi>M</mi><mo>,</mo>
         <msub>
          <mrow><mi> &beta; </mi>
          </mrow>
          <mrow><mi>M</mi>
          </mrow>
         </msub><mo> &sim; </mo>
         <mstyle mathvariant='normal'>
          <mrow><mi>B</mi><mi>r</mi>
          </mrow>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

          <mfrac>
           <mrow>
            <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

             <mrow>
              <msubsup>
               <mrow><mi>x</mi>
               </mrow>
               <mrow>
                <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
                </mrow>
               </mrow>
               <mrow><mi> &top; </mi>
               </mrow>
              </msubsup>
              <msub>
               <mrow><mi> &beta; </mi>
               </mrow>
               <mrow><mi>M</mi>
               </mrow>
              </msub>
             </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </mrow>
           <mrow>
            <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

             <mrow>
              <msubsup>
               <mrow><mi>x</mi>
               </mrow>
               <mrow>
                <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
                </mrow>
               </mrow>
               <mrow><mi> &top; </mi>
               </mrow>
              </msubsup>
              <msub>
               <mrow><mi> &beta; </mi>
               </mrow>
               <mrow><mi>M</mi>
               </mrow>
              </msub>
             </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

            </mrow>
           </mrow>
          </mfrac>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace />
         <msubsup>
          <mrow><mi>x</mi>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
           </mrow>
          </mrow>
          <mrow><mi> &top; </mi>
          </mrow>
         </msubsup>
         <msub>
          <mrow><mi> &beta; </mi>
          </mrow>
          <mrow><mi>M</mi>
          </mrow>
         </msub><mo>=</mo>
         <msub>
          <mrow><mo> &sum; </mo>
          </mrow>
          <mrow>
           <mrow><mi>j</mi><mo> &isin; </mo><mi>M</mi>
           </mrow>
          </mrow>
         </msub>
         <msubsup>
          <mrow><mi>x</mi>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
           </mrow>
          </mrow>
          <mrow><mi> &top; </mi>
          </mrow>
         </msubsup>
         <msub>
          <mrow><mi> &beta; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mspace width="20px" />
         <mstyle mathvariant='normal'>
          <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;
          </mrow>
         </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
        </mrow>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi> &beta; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>|</mo><mi>M</mi><mo> &sim; </mo>
         <mstyle mathvariant='normal'><mi>N</mi>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi> &beta; </mi>
           </mrow>
           <mrow><mi>j</mi>
           </mrow>
          </msub><mo>|</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="10px" /><mspace width="10px" />
         <mstyle mathvariant='normal'>
          <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>a</mi><mi>l</mi><mi>l</mi>
          </mrow>
         </mstyle><mspace /><mi>j</mi><mo> &notin; </mo><mi>M</mi>
        </mrow>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi> &beta; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>|</mo><mi>M</mi><mo> &sim; </mo>
         <mstyle mathvariant='normal'><mi>N</mi>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi> &beta; </mi>
           </mrow>
           <mrow><mi>j</mi>
           </mrow>
          </msub><mo>|</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
          </msub><mo>,</mo>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="10px" /><mspace width="10px" />
         <mstyle mathvariant='normal'>
          <mrow><mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>a</mi><mi>l</mi><mi>l</mi>
          </mrow>
         </mstyle><mspace /><mi>j</mi><mo> &isin; </mo><mi>M</mi>
        </mrow>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
      <mtr>
       <mtd><mrow/>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
      <mtr>
       <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
        <mtable>
         <mtr>
          <mtd><mi>M</mi>
          </mtd>
          <mtd>
           <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

            <mrow><mi>j</mi><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>}<mo>,</mo><mspace width="6px" />
             <mstyle mathvariant='normal'>
              <mrow><mi>s</mi><mn>.</mn><mi>t</mi><mn>.</mn>
              </mrow>
             </mstyle><mspace width="6px" />
             <msub>
              <mrow><mi> &gamma; </mi>
              </mrow>
              <mrow><mi>j</mi>
              </mrow>
             </msub><mo>=</mo><mn>1</mn>
            </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <msub>
             <mrow><mi> &gamma; </mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub><mo>|</mo><mi> &piv; </mi>
           </mrow>
          </mtd>
          <mtd>
           <mrow><mo> &sim; </mo>
            <mstyle mathvariant='normal'>
             <mrow><mi>B</mi><mi>r</mi>
             </mrow>
            </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &piv; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="10px" /><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
      <mtr>
       <mtd><mrow/>
       </mtd>
       <mtd><mrow/>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
     <mtable>
      <mtr>
       <mtd><mi> &piv; </mi>
       </mtd>
       <mtd>
        <mrow><mo> &sim; </mo>
         <mstyle mathvariant='normal'>
          <mrow><mi>B</mi><mi>e</mi>
          </mrow>
         </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msub>
           <mrow><mi>a</mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
          </msub><mo>,</mo>
          <msub>
           <mrow><mi>b</mi>
           </mrow>
           <mrow><mn>0</mn>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
  </mtable>
 </mrow></math> then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>M</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msub>
    <mrow><mo> &prod; </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo> &notin; </mo><mi>M</mi>
     </mrow>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>M</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle>
   <mstyle mathvariant='normal'>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>M</mi>
      </mrow>
     </mrow>
    </msub>
   </mstyle><mo>=</mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &int; </mo>
   <msub>
    <mrow><mo> &prod; </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo> &notin; </mo><mi>M</mi>
     </mrow>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle>
   <mstyle mathvariant='normal'>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>M</mi>
      </mrow>
     </mrow>
    </msub>
   </mstyle><mo>=</mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo><mi>M</mi><mo>,</mo><mi> &piv; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
</div>
</div>

<div class="standard" id='magicparlabel-568'><br />

</div>

<div class="standard" id='magicparlabel-569'><br />
</div>
<h2 class="section" id='magicparlabel-570'><span class="section_label">A</span> Appendix: Bayesian Normal Mixture model<a id="sec_Appendix_1" />
</h2>
<h3 class="subsection" id='magicparlabel-571'><span class="subsection_label">A.1</span> Case where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> is a fixed known parameter</h3>
<div class="standard" id='magicparlabel-572'>The complete R / RJAGS code is available from</div>

<ul class="itemize" id='magicparlabel-573'><li class="itemize_item"><span class="flex_url">http://htmlpreview.github.io/?https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Computer_practical/Normal_Mixture_model/Bayesian_Normal_Mixture_Model.nb.html</span></li>
<li class="itemize_item"><span class="flex_url">https://raw.githubusercontent.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/main/Computer_practical/Normal_Mixture_model/enz.dat</span></li>
</ul>

<div class="standard" id='magicparlabel-583'><br />

</div>

<div class="standard" id='magicparlabel-584'>For simplification, consider the hierarchical model where the number of groups <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> is a fixed/known quantity.<a id="eq_rwghorqewghqrg_2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow><mi>f</mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &piv; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi> &piv; </mi><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>D</mi><mi>i</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &delta; </mi><mo>,</mo><mn>...</mn><mo>,</mo><mi> &delta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>/</mo><mi> &kappa; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi> &beta; </mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>g</mi><mo>,</mo><mi>h</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(22)
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="note" id='magicparlabel-585'><div class="note_item"><span class="note_label">Note 23.</span>
The RJAGS code for the analysis of the data set in the Example <a href="#exa_Consider_the_following">7</a> is provided in Algorithm <a href="#alg_RJAGS_script_for_1">1</a>, however here the number of groups <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> is fixed/known quantity and not random. </div>
<div class="standard" id='magicparlabel-586'> </div>
<div class='float-algorithm'><div class="plain_layout" id='magicparlabel-590'><span style='font-family:monospace;'>rm(list=ls())</span></div>

<div class="plain_layout" id='magicparlabel-591'><span style='font-family:monospace;'># Load rjags</span></div>

<div class="plain_layout" id='magicparlabel-592'><span style='font-family:monospace;'>library("rjags")</span></div>

<div class="plain_layout" id='magicparlabel-593'><span style='font-family:monospace;'># define the Bayesian hierarchical model in JAGS syntax</span></div>

<div class="plain_layout" id='magicparlabel-594'><span style='font-family:monospace;'>jags_model &lt;- "</span></div>

<div class="plain_layout" id='magicparlabel-595'><span style='font-family:monospace;'>&emsp;model{</span></div>

<div class="plain_layout" id='magicparlabel-596'><span style='font-family:monospace;'>&emsp;&emsp;#sampling distribution</span></div>

<div class="plain_layout" id='magicparlabel-597'><span style='font-family:monospace;'>&emsp;&emsp;for (i in 1:n) {</span></div>

<div class="plain_layout" id='magicparlabel-598'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;y[i] ~ dnorm(mu[zeta[i]], tau[zeta[i]])</span></div>

<div class="plain_layout" id='magicparlabel-599'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;zeta[i] ~ dcat(varpi[])</span></div>

<div class="plain_layout" id='magicparlabel-600'><span style='font-family:monospace;'>&emsp;&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-601'><span style='font-family:monospace;'>&emsp;&emsp;#prior distribution</span></div>

<div class="plain_layout" id='magicparlabel-602'><span style='font-family:monospace;'>&emsp;&emsp;varpi ~ ddirich(delta)</span></div>

<div class="plain_layout" id='magicparlabel-603'><span style='font-family:monospace;'>&emsp;&emsp;for (i in 1:k) {</span></div>

<div class="plain_layout" id='magicparlabel-604'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;mu[i] ~ dnorm(xi,kappa)</span></div>

<div class="plain_layout" id='magicparlabel-605'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;tau[i] ~ dgamma(alpha,beta)</span></div>

<div class="plain_layout" id='magicparlabel-606'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;sigma[i] &lt;- 1/sqrt(tau[i])</span></div>

<div class="plain_layout" id='magicparlabel-607'><span style='font-family:monospace;'>&emsp;&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-608'><span style='font-family:monospace;'>&emsp;&emsp;beta ~ dgamma(g,h)</span></div>

<div class="plain_layout" id='magicparlabel-609'><span style='font-family:monospace;'>}</span></div>

<div class="plain_layout" id='magicparlabel-610'><span style='font-family:monospace;'>"</span></div>

<div class="plain_layout" id='magicparlabel-611'><span class='float-caption-Standard float-caption float-caption-standard'>Algorithm 1:  [Bayesian Normal Mixture model] RJAGS script for the analysis of the data set in the Example <a href="#exa_Consider_the_following">7</a> . <a id="alg_RJAGS_script_for_1" />
</span></div>
</div>

</div>

<div class="standard" id='magicparlabel-616'><br />

</div>

<div class="example" id='magicparlabel-617'><div class="example_item"><span class="example_label">Example 24.</span>
<div class="marginal"><div class="plain_layout" id='magicparlabel-621'>Snapshot for Term 2</div>
</div>(Cont. Example <a href="#exa_Consider_the_following">7</a>) As we will see in term 2, although <a href="#eq_rwghorqewghqrg">(5)</a> and <a href="#eq_rfkgjgjdrfag">10</a> are equivalent in the sense that they produce the same inference, the expended hierarchical model <a href="#eq_yhjgksdgfhdsh">(7)</a> is computational convenient compared to hierarchical model <a href="#eq_thdahdghjrfhjdgh">(12)</a> in the sense that its priors are conditional conjugate.</div>
<div class="standard" id='magicparlabel-622'>For simplicity assume that the number of groups is known and fixed to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math>. The full conditional posteriors in model <a href="#eq_yhjgksdgfhdsh">(7)</a> are: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>w</mi><mo>|</mo><mi>y</mi><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>D</mi><mi>i</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &delta; </mi><mo>+</mo>
      <msub>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo><mn>...</mn><mo>,</mo><mi> &delta; </mi><mo>+</mo>
      <msub>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>k</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>;</mo><mspace />
     <mstyle mathvariant='normal'>
      <mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi>
      </mrow>
     </mstyle><mspace />
     <msub>
      <mrow><mi>n</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup>
     <mstyle mathvariant='normal'><mn>1</mn>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>=</mo><mi>j</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo>|</mo><mi>y</mi><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow>
        <mrow>
         <msub>
          <mrow><mo> &sum; </mo>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>:</mo>
            <msub>
             <mrow><mi>z</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub><mo>=</mo><mi>j</mi>
           </mrow>
          </mrow>
         </msub>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>-</mo><mi> &xi; </mi><mi> &kappa; </mi>
        </mrow>
       </mrow>
       <mrow>
        <mrow>
         <msub>
          <mrow><mi>n</mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>+</mo><mi> &kappa; </mi>
        </mrow>
       </mrow>
      </mfrac><mo>,</mo>
      <mfrac>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
       <mrow>
        <mrow>
         <msub>
          <mrow><mi>n</mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub><mo>+</mo><mi> &kappa; </mi>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>|</mo><mi>y</mi><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>I</mi><mi>G</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>a</mi><mo>+</mo>
      <mfrac>
       <mrow>
        <msub>
         <mrow><mi>n</mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac><mo>,</mo><mi> &beta; </mi><mo>+</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>:</mo>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>=</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub><mo>(</mo>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>-</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub>
      <msup>
       <mrow><mo>)</mo>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo>|</mo><mi>y</mi><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>=</mo><mi>j</mi><mo>|</mo><mi>y</mi><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mfrac>
         <mrow>
          <msub>
           <mrow><mi>w</mi>
           </mrow>
           <mrow><mi>j</mi>
           </mrow>
          </msub>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>j</mi>
           </mrow>
          </msub>
         </mrow>
        </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo>-</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac>
         <mfrac>
          <mrow>
           <mrow><mo>(</mo>
            <msub>
             <mrow><mi>y</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub><mo>-</mo>
            <msub>
             <mrow><mi> &mu; </mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub>
            <msup>
             <mrow><mo>)</mo>
             </mrow>
             <mrow><mn>2</mn>
             </mrow>
            </msup>
           </mrow>
          </mrow>
          <mrow>
           <msubsup>
            <mrow><mi> &sigma; </mi>
            </mrow>
            <mrow><mi>j</mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mfrac>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <msubsup>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow>
          <mrow><mi>j</mi><mo>'</mo><mo>=</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi>k</mi>
         </mrow>
        </msubsup>
        <mfrac>
         <mrow>
          <msub>
           <mrow><mi>w</mi>
           </mrow>
           <mrow>
            <mrow><mi>j</mi><mo>'</mo>
            </mrow>
           </mrow>
          </msub>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow>
            <mrow><mi>j</mi><mo>'</mo>
            </mrow>
           </mrow>
          </msub>
         </mrow>
        </mfrac><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo>-</mo>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </mfrac>
         <mfrac>
          <mrow>
           <mrow><mo>(</mo>
            <msub>
             <mrow><mi>y</mi>
             </mrow>
             <mrow><mi>i</mi>
             </mrow>
            </msub><mo>-</mo>
            <msub>
             <mrow><mi> &mu; </mi>
             </mrow>
             <mrow>
              <mrow><mi>j</mi><mo>'</mo>
              </mrow>
             </mrow>
            </msub>
            <msup>
             <mrow><mo>)</mo>
             </mrow>
             <mrow><mn>2</mn>
             </mrow>
            </msup>
           </mrow>
          </mrow>
          <mrow>
           <msubsup>
            <mrow><mi> &sigma; </mi>
            </mrow>
            <mrow>
             <mrow><mi>j</mi><mo>'</mo>
             </mrow>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mfrac>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac><mo>;</mo><mspace />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="6px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &beta; </mi><mo>|</mo><mi>y</mi><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>G</mi><mi>a</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>g</mi><mo>+</mo><mi>k</mi><mi> &alpha; </mi><mo>,</mo><mi>h</mi><mo>+</mo>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>k</mi>
       </mrow>
      </msubsup>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math> which can be used in Monte Carlo integration.</div>

<div class="standard" id='magicparlabel-623'>Model <a href="#eq_thdahdghjrfhjdgh">(12)</a> does not produce full conditional posteriors of standard form, due to the summation in the likelihood.</div>
</div>
<h3 class="subsection" id='magicparlabel-624'><span class="subsection_label">A.2</span> Case where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> is a random/unknown parameter</h3>
<div class="standard" id='magicparlabel-625'>The complete R / RJAGS code is available from</div>

<ul class="itemize" id='magicparlabel-626'><li class="itemize_item"><span class="flex_url">http://htmlpreview.github.io/?https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Computer_practical/Normal_Mixture_Model_unknown_number_of_components/Bayesian_Normal_Mixture_Model_unknown_number_of_components.nb.html</span></li>
<li class="itemize_item"><span class="flex_url">https://raw.githubusercontent.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/main/Computer_practical/Normal_Mixture_Model_unknown_number_of_components/enz.dat</span></li>
</ul>

<div class="note" id='magicparlabel-636'><div class="note_item"><span class="note_label">Note 25.</span>
Consider the hierarchical model <a href="#eq_rwghorqewghqrg">5</a>. </div>
</div>

<div class="standard" id='magicparlabel-637'><br />

</div>

<div class="note" id='magicparlabel-638'><div class="note_item"><span class="note_label">Note 26.</span>
Notice that the length of the join unknown parameter vector <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi>k</mi><mo>,</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is not fixed but random because <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> is random/unknown. Current versions of JAGS work only when the join unknown parameter vector of the Bayesian hierarchical model is fixed. </div>
</div>

<div class="standard" id='magicparlabel-639'><br />

</div>

<div class="note" id='magicparlabel-640'><div class="note_item"><span class="note_label">Note 27.</span>
It is given that if <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
  </mrow>
 </mrow></math> then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mfrac>
     <mrow>
      <msub>
       <mrow><mi>c</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mrow>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow><mi>k</mi>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>c</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mfrac><mo>,</mo><mn>...</mn><mo>,</mo>
    <mfrac>
     <mrow>
      <msub>
       <mrow><mi>c</mi>
       </mrow>
       <mrow><mi>k</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mrow>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow><mi>k</mi>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>c</mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>D</mi><mi>i</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mi>k</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
  </mrow>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-641'><br />

</div>

<div class="note" id='magicparlabel-642'><div class="note_item"><span class="note_label">Note 28.</span>
To make JAGS work on our problem we augment <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow>
   <msub>
    <mrow><mi>z</mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi>k</mi><mo>,</mo>
   <msub>
    <mrow><mi> &piv; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
     </mrow>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> with additional random variables<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>c</mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo>|</mo><mi>k</mi>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>G</mi><mi>a</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &delta; </mi><mo>,</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mstyle class='math'><mo> max </mo>
        </mstyle>
       </mstyle>
      </mrow>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub><mo>|</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo><mi>k</mi>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &xi; </mi><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>/</mo><mi> &kappa; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mstyle class='math'><mo> max </mo>
        </mstyle>
       </mstyle>
      </mrow>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>I</mi><mi>G</mi>
      </mrow>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
     <mstyle mathvariant='normal'>
      <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
      </mrow>
     </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mstyle class='math'><mo> max </mo>
        </mstyle>
       </mstyle>
      </mrow>
     </msub>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math>Precisely, we consider the augmented Bayesian hierarchical model</div>
</div>

<div class="standard" id='magicparlabel-643'><br />

</div>

<div class="note" id='magicparlabel-644'><div class="note_item"><span class="note_label">Note 29.</span>
Consider augmentation where <a href="#eq_rwghorqewghqrg">(5)</a> is augmented by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>|</mo><mi>k</mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &xi; </mi><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>/</mo><mi> &kappa; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>I</mi><mi>G</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &delta; </mi><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> <a id="eq_rwghorqewghqrg_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>,</mo><mi>k</mi><mo>,</mo><mi> &piv; </mi><mo>,</mo><mi> &mu; </mi><mo>,</mo>
        <msup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow><mi>f</mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>y</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi> &piv; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &mu; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
         </msub><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>:</mo><mo>=</mo>
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
         </mrow>
        </msub><mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi> &piv; </mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <mfrac>
          <mrow>
           <msub>
            <mrow><mi>c</mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
          </mrow>
          <mrow>
           <mrow>
            <msubsup>
             <mrow><mo> &sum; </mo>
             </mrow>
             <mrow>
              <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
              </mrow>
             </mrow>
             <mrow><mi>k</mi>
             </mrow>
            </msubsup>
            <msub>
             <mrow><mi>c</mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub>
           </mrow>
          </mrow>
         </mfrac><mo>,</mo><mn>...</mn><mo>,</mo>
         <mfrac>
          <mrow>
           <msub>
            <mrow><mi>c</mi>
            </mrow>
            <mrow><mi>k</mi>
            </mrow>
           </msub>
          </mrow>
          <mrow>
           <mrow>
            <msubsup>
             <mrow><mo> &sum; </mo>
             </mrow>
             <mrow>
              <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
              </mrow>
             </mrow>
             <mrow><mi>k</mi>
             </mrow>
            </msubsup>
            <msub>
             <mrow><mi>c</mi>
             </mrow>
             <mrow><mi>j</mi>
             </mrow>
            </msub>
           </mrow>
          </mrow>
         </mfrac>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi>c</mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &delta; </mi><mo>,</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
        <msub>
         <mrow><mi>k</mi>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mstyle class='math'><mo> max </mo>
           </mstyle>
          </mstyle>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>/</mo><mi> &kappa; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
        <msub>
         <mrow><mi>k</mi>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mstyle class='math'><mo> max </mo>
           </mstyle>
          </mstyle>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo>
        <msub>
         <mrow><mi>k</mi>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mstyle class='math'><mo> max </mo>
           </mstyle>
          </mstyle>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd><mrow/>
      </mtd>
      <mtd><mrow/>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
        </msub><mo>|</mo>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'><mi>N</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &xi; </mi><mo>,</mo>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup><mo>/</mo><mi> &kappa; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" />
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>j</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mo>|</mo><mi> &beta; </mi><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>I</mi><mi>G</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mspace width="20px" /><mspace width="20px" /><mspace width="20px" /><mspace width="20px" />
        <mstyle mathvariant='normal'>
         <mrow><mi>f</mi><mi>o</mi><mi>r</mi>
         </mrow>
        </mstyle><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>k</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi> &beta; </mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <mstyle mathvariant='normal'>
         <mrow><mi>G</mi><mi>a</mi>
         </mrow>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>g</mi><mo>,</mo><mi>h</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow><mspace width="20px" /><mspace width="20px" /><mi>k</mi>
       </mrow>
      </mtd>
      <mtd>
       <mrow><mo> &sim; </mo>
        <msub>
         <mrow>
          <mstyle mathvariant='normal'><mi>U</mi>
          </mstyle>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'>
           <mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>c</mi><mi>r</mi>
           </mrow>
          </mstyle>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>1</mn><mo>,</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mtd>
   <mtd>(23)
   </mtd>
  </mtr>
 </mtable></math>then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi>k</mi><mo>,</mo>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo>
       <msub>
        <mrow><mi>k</mi>
        </mrow>
        <mrow><mo> max </mo>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo>
       <msub>
        <mrow><mi>k</mi>
        </mrow>
        <mrow><mo> max </mo>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msub>
     <mrow><mi>c</mi>
     </mrow>
     <mrow>
      <mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>:</mo><mn>1</mn><mo>:</mo>
       <msub>
        <mrow><mi>k</mi>
        </mrow>
        <mrow><mo> max </mo>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi>k</mi><mo>,</mo>
    <msub>
     <mrow><mi> &piv; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
      </mrow>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <msubsup>
    <mrow><mo> &prod; </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>k</mi>
      </mrow>
      <mrow><mo> max </mo>
      </mrow>
     </msub>
    </mrow>
   </msubsup>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo><mi> &xi; </mi><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>/</mo><mi> &kappa; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>k</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>|</mo><mi> &alpha; </mi><mo>,</mo><mi> &beta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'>
    <mrow><mi>G</mi><mi>a</mi>
    </mrow>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>c</mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo><mi> &delta; </mi><mo>,</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> &int; </mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo><mi>k</mi><mo>,</mo>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>,</mo>
      <msub>
       <mrow><mi>c</mi>
       </mrow>
       <mrow>
        <mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>:</mo><mn>1</mn><mo>:</mo>
         <msub>
          <mrow><mi>k</mi>
          </mrow>
          <mrow><mo> max </mo>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow>
         <mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>:</mo>
          <msub>
           <mrow><mi>k</mi>
           </mrow>
           <mrow><mo> max </mo>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </msub><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow>
         <mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>:</mo>
          <msub>
           <mrow><mi>k</mi>
           </mrow>
           <mrow><mo> max </mo>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup><mo>,</mo>
       <msub>
        <mrow><mi>c</mi>
        </mrow>
        <mrow>
         <mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>:</mo><mn>1</mn><mo>:</mo>
          <msub>
           <mrow><mi>k</mi>
           </mrow>
           <mrow><mo> max </mo>
           </mrow>
          </msub>
         </mrow>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mstyle>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo><mi>k</mi><mo>,</mo>
      <msub>
       <mrow><mi> &piv; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>k</mi>
        </mrow>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>
<div class="note_item">The RJAGS code for the analysis of the data set in the Example <a href="#exa_Consider_the__Challenger">12</a> is provided in Algorithm <a href="#alg_RJAGS_script_for_1_1_1">2</a>. </div>
<div class="standard" id='magicparlabel-646'> </div>
<div class='float-algorithm'><div class="plain_layout" id='magicparlabel-650'><span style='font-family:monospace;'>rm(list=ls())</span></div>

<div class="plain_layout" id='magicparlabel-651'><span style='font-family:monospace;'># Load rjags</span></div>

<div class="plain_layout" id='magicparlabel-652'><span style='font-family:monospace;'>library("rjags")</span></div>

<div class="plain_layout" id='magicparlabel-653'><span style='font-family:monospace;'># define the Bayesian hierarchical model in JAGS syntax</span></div>

<div class="plain_layout" id='magicparlabel-654'><span style='font-family:monospace;'>jags_model &lt;- " </span></div>

<div class="plain_layout" id='magicparlabel-655'><span style='font-family:monospace;'>&emsp;model{ </span></div>

<div class="plain_layout" id='magicparlabel-656'><span style='font-family:monospace;'>&emsp;# sampling distribution </span></div>

<div class="plain_layout" id='magicparlabel-657'><span style='font-family:monospace;'>&emsp;for (i in 1:n) { </span></div>

<div class="plain_layout" id='magicparlabel-658'><span style='font-family:monospace;'>&emsp;&emsp;y[i] ~ dnorm(mu[zeta[i]], tau[zeta[i]]) </span></div>

<div class="plain_layout" id='magicparlabel-659'><span style='font-family:monospace;'>&emsp;&emsp;zeta[i] ~ dcat( varpi ) } </span></div>

<div class="plain_layout" id='magicparlabel-660'><span style='font-family:monospace;'>&emsp;&emsp;# within model parameter priors </span></div>

<div class="plain_layout" id='magicparlabel-661'><span style='font-family:monospace;'>&emsp;&emsp;for (i in 1:length(pk) ) { </span></div>

<div class="plain_layout" id='magicparlabel-662'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;x[i] ~ dgamma(delta[i],1) </span></div>

<div class="plain_layout" id='magicparlabel-663'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;ind[i] &lt;- (i&lt;=k) </span></div>

<div class="plain_layout" id='magicparlabel-664'><span style='font-family:monospace;'>&emsp;&emsp;} </span></div>

<div class="plain_layout" id='magicparlabel-665'><span style='font-family:monospace;'>&emsp;&emsp;varpi &lt;- (x*ind)/sum(x*ind) </span></div>

<div class="plain_layout" id='magicparlabel-666'><span style='font-family:monospace;'>&emsp;&emsp;for (i in 1:length(pk) ) { </span></div>

<div class="plain_layout" id='magicparlabel-667'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;mu[i] ~ dnorm(xi,kappa) </span></div>

<div class="plain_layout" id='magicparlabel-668'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;tau[i] ~ dgamma(alpha,beta) </span></div>

<div class="plain_layout" id='magicparlabel-669'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;sigma[i] &lt;- 1/sqrt(tau[i]) </span></div>

<div class="plain_layout" id='magicparlabel-670'><span style='font-family:monospace;'>&emsp;&emsp;} </span></div>

<div class="plain_layout" id='magicparlabel-671'><span style='font-family:monospace;'>&emsp;&emsp;beta ~ dgamma(g,h) </span></div>

<div class="plain_layout" id='magicparlabel-672'><span style='font-family:monospace;'>&emsp;&emsp;k~dcat(pk) </span></div>

<div class="plain_layout" id='magicparlabel-673'><span style='font-family:monospace;'>&emsp;} </span></div>

<div class="plain_layout" id='magicparlabel-674'><span style='font-family:monospace;'>&emsp;"</span></div>

<div class="plain_layout" id='magicparlabel-675'><span class='float-caption-Standard float-caption float-caption-standard'>Algorithm 2:  [Bayesian Normal Mixture model] RJAGS script for the analysis of the data set in the Example <a href="#exa_Consider_the_following">7</a> . <a id="alg_RJAGS_script_for_1_1_1" />
</span></div>
</div>

</div>

<div class="standard" id='magicparlabel-680'><br />

</div>

<div class="standard" id='magicparlabel-681'><br />
</div>
<h2 class="section" id='magicparlabel-682'><span class="section_label">B</span> Appendix: Bayesian Variable Selection in Logistic regression model<a id="sec_Appendix_1_1" />
</h2>
<div class="standard" id='magicparlabel-683'>The complete R / RJAGS code is available from</div>

<ul class="itemize" id='magicparlabel-684'><li class="itemize_item"><span class="flex_url">http://htmlpreview.github.io/?https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Computer_practical/Bernoulli_regression_model_variable_selection/Bernoulli_Regression_Model_VS_full.nb.html</span></li>
</ul>

<div class="standard" id='magicparlabel-689'><br />

</div>

<div class="note" id='magicparlabel-690'><div class="note_item"><span class="note_label">Note 30.</span>
Notice that the length of the join unknown parameter vector <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>M</mi><mo>,</mo>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>M</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &gamma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi> &piv; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is not fixed but random because <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>M</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

   <mrow><mi>j</mi><mo> &isin; </mo>{<mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>}<mo>,</mo><mspace width="6px" />
    <mstyle mathvariant='normal'>
     <mrow><mi>s</mi><mn>.</mn><mi>t</mi><mn>.</mn>
     </mrow>
    </mstyle><mspace width="6px" />
    <msub>
     <mrow><mi> &gamma; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>=</mo><mn>1</mn>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

  </mrow>
 </mrow></math> is random/unknown. Current versions of JAGS work only when the join unknown parameter vector of the Bayesian hierarchical model is fixed. </div>
</div>

<div class="standard" id='magicparlabel-691'><br />

</div>

<div class="note" id='magicparlabel-692'><div class="note_item"><span class="note_label">Note 31.</span>
To make JAGS work on our problem we 'cheat' by augmenting <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>M</mi><mo>,</mo>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>M</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &gamma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi> &piv; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> with additional random variables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>j</mi>
    </mrow>
   </msub><mo>|</mo><mi>j</mi><mo> &notin; </mo><mi>M</mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>0</mn>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Precisely, we consider the augmented Bayesian hierarchical model<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
  <mtable>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>M</mi><mo>,</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mi>M</mi>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd>
     <mrow><mo> &sim; </mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>o</mi><mi>u</mi><mi>l</mi><mi>l</mi><mi>i</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>x</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>;</mo><mi>M</mi><mo>,</mo>
        <msub>
         <mrow><mi> &beta; </mi>
         </mrow>
         <mrow><mi>M</mi>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="20px" />
      <mstyle mathvariant='normal'>
       <mrow><mi>f</mi><mi>o</mi><mi>r</mi><mo>,</mo>&nbsp;
       </mrow>
      </mstyle><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow><mi>p</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>;</mo><mi>M</mi><mo>,</mo>
       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mi>M</mi>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow><mo>=</mo>
      <mfrac>
       <mrow>
        <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msubsup>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
            </mrow>
           </mrow>
           <mrow><mi> &top; </mi>
           </mrow>
          </msubsup>
          <msub>
           <mrow><mi> &beta; </mi>
           </mrow>
           <mrow><mi>M</mi>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>+</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow>
          <msubsup>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
            </mrow>
           </mrow>
           <mrow><mi> &top; </mi>
           </mrow>
          </msubsup>
          <msub>
           <mrow><mi> &beta; </mi>
           </mrow>
           <mrow><mi>M</mi>
           </mrow>
          </msub>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mrow>
      </mfrac><mo>;</mo><mspace width="6px" /><mspace width="6px" />
      <mstyle mathvariant='normal'>
       <mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mspace width="6px" />
      <msubsup>
       <mrow><mi>x</mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>M</mi>
        </mrow>
       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msubsup>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mi>M</mi>
       </mrow>
      </msub><mo>=</mo>
      <msub>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo> &isin; </mo><mi>M</mi>
        </mrow>
       </mrow>
      </msub>
      <msub>
       <mrow><mi>x</mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo>|</mo><mi>j</mi><mo> &notin; </mo><mi>M</mi>
     </mrow>
    </mtd>
    <mtd>
     <mrow><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="10px" /><mspace width="10px" /><mi>j</mi><mo> &notin; </mo><mi>M</mi>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo>|</mo><mi>j</mi><mo> &isin; </mo><mi>M</mi>
     </mrow>
    </mtd>
    <mtd>
     <mrow><mo> &sim; </mo>
      <mstyle mathvariant='normal'><mi>N</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &beta; </mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi> &mu; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub><mo>,</mo>
       <msubsup>
        <mrow><mi> &sigma; </mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msubsup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="10px" /><mspace width="10px" /><mi>j</mi><mo> &isin; </mo><mi>M</mi>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mi>M</mi>
    </mtd>
    <mtd>
     <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

      <mrow><mi>j</mi><mo> &isin; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

       <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo><mspace width="6px" />
       <mstyle mathvariant='normal'>
        <mrow><mi>s</mi><mn>.</mn><mi>t</mi><mn>.</mn>
        </mrow>
       </mstyle><mspace width="6px" />
       <msub>
        <mrow><mi> &gamma; </mi>
        </mrow>
        <mrow><mi>j</mi>
        </mrow>
       </msub><mo>=</mo><mn>1</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <msub>
      <mrow><mi> &gamma; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub>
    </mtd>
    <mtd>
     <mrow><mo> &sim; </mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>o</mi><mi>u</mi><mi>l</mi><mi>l</mi><mi>i</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &piv; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="10px" /><mspace width="10px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>d</mi>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mrow/>
    </mtd>
    <mtd><mrow/>
    </mtd>
   </mtr>
   <mtr>
    <mtd><mi> &piv; </mi>
    </mtd>
    <mtd>
     <mrow><mo> &sim; </mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>B</mi><mi>e</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub><mo>,</mo>
       <msub>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mn>0</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
   </mtr>
  </mtable>
 </mrow></math></div>
</div>

<div class="standard" id='magicparlabel-693'><br />

</div>

<div class="standard" id='magicparlabel-694'>Now we work on the augmented vector <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mi>M</mi><mo>,</mo>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow><mi>M</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow><mi> &comp; </mi>
      </mrow>
     </msup>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &gamma; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo><mi> &piv; </mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>. The augmented hierarchical model admits the hierarchical model as its marginal because <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>M</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &gamma; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi> &piv; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>M</mi><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>M</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow>
      <msup>
       <mrow><mi>M</mi>
       </mrow>
       <mrow><mi> &comp; </mi>
       </mrow>
      </msup>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &gamma; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>d</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo><mi> &piv; </mi><mo>|</mo><mi>y</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle>
   <msub>
    <mrow><mi> &beta; </mi>
    </mrow>
    <mrow>
     <msup>
      <mrow><mi>M</mi>
      </mrow>
      <mrow><mi> &comp; </mi>
      </mrow>
     </msup>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></div>

<div class="note" id='magicparlabel-695'><div class="note_item"><span class="note_label">Note 32.</span>
The RJAGS code for the analysis of the data set in the Example <a href="#exa_Consider_the__Challenger">12</a> is provided in Algorithm <a href="#alg_RJAGS_script_for_1_1">3</a>. </div>
<div class="standard" id='magicparlabel-696'> </div>
<div class='float-algorithm'><div class="plain_layout" id='magicparlabel-700'><span style='font-family:monospace;'>rm(list=ls())</span></div>

<div class="plain_layout" id='magicparlabel-701'><span style='font-family:monospace;'># Load rjags</span></div>

<div class="plain_layout" id='magicparlabel-702'><span style='font-family:monospace;'>library("rjags")</span></div>

<div class="plain_layout" id='magicparlabel-703'><span style='font-family:monospace;'># define the Bayesian hierarchical model in JAGS syntax</span></div>

<div class="plain_layout" id='magicparlabel-704'><span style='font-family:monospace;'>hierarhicalmodel&lt;-"</span></div>

<div class="plain_layout" id='magicparlabel-705'><span style='font-family:monospace;'>model {</span></div>

<div class="plain_layout" id='magicparlabel-706'><span style='font-family:monospace;'>&emsp;# sampling distribution </span></div>

<div class="plain_layout" id='magicparlabel-707'><span style='font-family:monospace;'>&emsp;for (i in 1:n) { </span></div>

<div class="plain_layout" id='magicparlabel-708'><span style='font-family:monospace;'>&emsp;&emsp;eta[i] &lt;- inprod(X[i,],beta*ind) </span></div>

<div class="plain_layout" id='magicparlabel-709'><span style='font-family:monospace;'>&emsp;&emsp;mean[i] &lt;- exp( eta[i] ) / ( 1 + exp( eta[i] ) ) </span></div>

<div class="plain_layout" id='magicparlabel-710'><span style='font-family:monospace;'>&emsp;&emsp;y[i] ~ dbern(mean[i]) </span></div>

<div class="plain_layout" id='magicparlabel-711'><span style='font-family:monospace;'>&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-712'><span style='font-family:monospace;'>&emsp;# within model prior + augmentation </span></div>

<div class="plain_layout" id='magicparlabel-713'><span style='font-family:monospace;'>&emsp;for ( j in 1:dmax ) { </span></div>

<div class="plain_layout" id='magicparlabel-714'><span style='font-family:monospace;'>&emsp;&emsp;beta[j] ~ dnorm( 0 , 0.1 ) </span></div>

<div class="plain_layout" id='magicparlabel-715'><span style='font-family:monospace;'>&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-716'><span style='font-family:monospace;'>&emsp;</span># marginal model prior </div>

<div class="plain_layout" id='magicparlabel-717'><span style='font-family:monospace;'>&emsp;</span>ind[1] &lt;- 1 </div>

<div class="plain_layout" id='magicparlabel-718'><span style='font-family:monospace;'>&emsp;</span>for (j in 2:dmax) {</div>

<div class="plain_layout" id='magicparlabel-719'><span style='font-family:monospace;'>&emsp;&emsp;</span>ind[j] ~ dbern( pp )</div>

<div class="plain_layout" id='magicparlabel-720'><span style='font-family:monospace;'>&emsp;</span>}</div>

<div class="plain_layout" id='magicparlabel-721'><span style='font-family:monospace;'>&emsp;</span># hyper-prior </div>

<div class="plain_layout" id='magicparlabel-722'><span style='font-family:monospace;'>&emsp;</span>pp ~ dbeta(1.0,1.0)</div>

<div class="plain_layout" id='magicparlabel-723'><span style='font-family:monospace;'>}</span></div>

<div class="plain_layout" id='magicparlabel-724'><span style='font-family:monospace;'>"</span></div>

<div class="plain_layout" id='magicparlabel-725'><span class='float-caption-Standard float-caption float-caption-standard'>Algorithm 3:  [Bayesian Mixed Effect Model] RJAGS script for the analysis of the data set in the Example <a href="#exa_Consider_the_following">7</a> . <a id="alg_RJAGS_script_for_1_1" />
</span></div>
</div>

</div>

<div class="standard" id='magicparlabel-730'><br />

</div>

<div class="standard" id='magicparlabel-731'><br />
</div>
<h2 class="section" id='magicparlabel-732'><span class="section_label">C</span> Appendix: Random effect model <a id="sec_Appendix" />
</h2>

<div class="standard" id='magicparlabel-733'><br />

</div>

<div class="standard" id='magicparlabel-734'>The complete R / RJAGS code is available from</div>

<ul class="itemize" id='magicparlabel-735'><li class="itemize_item"><span class="flex_url">https://github.com/georgios-stats/Bayesian_Statistics_Michaelmas_2021/blob/main/Lecture_handouts/Rscripts/Hierarchical_bayes/HierarchicalBayesPharmaceutical.R</span></li>
</ul>

<div class="note" id='magicparlabel-740'><div class="note_item"><span class="note_label">Note 33.</span>
The RJAGS code for the analysis of the data set in the Example <a href="#exa_Robert_and_Reber">13</a> is provided in Algorithm <a href="#alg_RJAGS_script_for">4</a>. </div>

<div class='float-algorithm'><div class="plain_layout" id='magicparlabel-745'><span style='font-family:monospace;'>rm(list=ls())</span></div>

<div class="plain_layout" id='magicparlabel-746'><span style='font-family:monospace;'># Load rjags</span></div>

<div class="plain_layout" id='magicparlabel-747'><span style='font-family:monospace;'>library("rjags")</span></div>

<div class="plain_layout" id='magicparlabel-748'><span style='font-family:monospace;'># define the Bayesian hierarchical model in JAGS syntax</span></div>

<div class="plain_layout" id='magicparlabel-749'><span style='font-family:monospace;'>hierarhicalmodel &lt;- "</span></div>

<div class="plain_layout" id='magicparlabel-750'><span style='font-family:monospace;'>&emsp;model {</span></div>

<div class="plain_layout" id='magicparlabel-751'><span style='font-family:monospace;'>&emsp;&emsp; for ( i in 1 : I ) {</span></div>

<div class="plain_layout" id='magicparlabel-752'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;for ( j in 1 : J ) {</span></div>

<div class="plain_layout" id='magicparlabel-753'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;&emsp;x[i,j] ~ dnorm( theta[i] , tau_c )</span></div>

<div class="plain_layout" id='magicparlabel-754'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;&emsp;y[i,j] ~ dnorm( theta[i] + delta[i] , tau_a )</span></div>

<div class="plain_layout" id='magicparlabel-755'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;&emsp;z[i,j] ~ dnorm( theta[i] + delta[i] + xi[i] , tau_t )</span></div>

<div class="plain_layout" id='magicparlabel-756'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-757'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;theta[i] ~ dnorm( mu_theta , tau_theta )</span></div>

<div class="plain_layout" id='magicparlabel-758'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;delta[i] ~ dnorm( mu_delta , tau_delta )</span></div>

<div class="plain_layout" id='magicparlabel-759'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;w_ind[i] &lt;- ifelse(w[i] == 0, 0, 1)</span></div>

<div class="plain_layout" id='magicparlabel-760'><span style='font-family:monospace;'>&emsp;&emsp;&emsp;xi[i] &lt;- w_ind[i]*x_d +(1-w_ind[i])*x_p</span></div>

<div class="plain_layout" id='magicparlabel-761'><span style='font-family:monospace;'>&emsp;&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-762'><span style='font-family:monospace;'>&emsp;&emsp;sig2_c &lt;- 1/tau_c tau_c ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-763'><span style='font-family:monospace;'>&emsp;&emsp;sig2_a = 1/tau_a tau_a ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-764'><span style='font-family:monospace;'>&emsp;&emsp;sig2_t &lt;- 1/tau_t tau_t ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-765'><span style='font-family:monospace;'>&emsp;&emsp;mu_theta ~ dnorm( 0 , 0.001 )</span></div>

<div class="plain_layout" id='magicparlabel-766'><span style='font-family:monospace;'>&emsp;&emsp;sig2_theta = 1/tau_theta</span></div>

<div class="plain_layout" id='magicparlabel-767'><span style='font-family:monospace;'>&emsp;&emsp;tau_theta ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-768'><span style='font-family:monospace;'>&emsp;&emsp;mu_delta ~ dnorm( 0 , 0.001 )</span></div>

<div class="plain_layout" id='magicparlabel-769'><span style='font-family:monospace;'>&emsp;&emsp;sig2_delta &lt;- 1/tau_delta</span></div>

<div class="plain_layout" id='magicparlabel-770'><span style='font-family:monospace;'>&emsp;&emsp;tau_delta ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-771'><span style='font-family:monospace;'>&emsp;&emsp;x_p ~ dnorm( mu_p , tau_p )</span></div>

<div class="plain_layout" id='magicparlabel-772'><span style='font-family:monospace;'>&emsp;&emsp;x_d ~ dnorm( mu_d , tau_d )</span></div>

<div class="plain_layout" id='magicparlabel-773'><span style='font-family:monospace;'>&emsp;&emsp;mu_p ~ dnorm( 0 , 0.001 )</span></div>

<div class="plain_layout" id='magicparlabel-774'><span style='font-family:monospace;'>&emsp;&emsp;sig2_p &lt;- 1/tau_p</span></div>

<div class="plain_layout" id='magicparlabel-775'><span style='font-family:monospace;'>&emsp;&emsp;tau_p ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-776'><span style='font-family:monospace;'>&emsp;&emsp;mu_d ~ dnorm( 0 , 0.001 )</span></div>

<div class="plain_layout" id='magicparlabel-777'><span style='font-family:monospace;'>&emsp;&emsp;sig2_d &lt;- 1/tau_d</span></div>

<div class="plain_layout" id='magicparlabel-778'><span style='font-family:monospace;'>&emsp;&emsp;tau_d ~ dgamma(0.01 , 0.01)</span></div>

<div class="plain_layout" id='magicparlabel-779'><span style='font-family:monospace;'>&emsp;}</span></div>

<div class="plain_layout" id='magicparlabel-780'><span style='font-family:monospace;'>"</span></div>

<div class="plain_layout" id='magicparlabel-781'><span class='float-caption-Standard float-caption float-caption-standard'>Algorithm 4:  [Random effect model] RJAGS script for the analysis of the data set in the Example <a href="#exa_Robert_and_Reber">13</a>. <a id="alg_RJAGS_script_for" />
</span></div>
</div>

</div>



<div class="standard" id='magicparlabel-830'><br />

</div>

<div class="example" id='magicparlabel-831'><div class="example_item"><span class="example_label">Example 34.</span>
(Cont...) You may use  <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>-</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup>
   <mfrac>
    <mrow>
     <mrow><mo>(</mo><mi>x</mi><mo>-</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
      <msup>
       <mrow><mo>)</mo>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
   </mfrac><mo>=</mo><mo>-</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <mfrac>
    <mrow>
     <mrow><mo>(</mo><mi>x</mi><mo>-</mo>
      <mover>
       <mrow><mi> &mu; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
      <msup>
       <mrow><mo>)</mo>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <msup>
      <mrow>
       <mover>
        <mrow><mi> &sigma; </mi>
        </mrow><mo stretchy="true">&circ;</mo>
       </mover>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
   </mfrac><mo>+</mo><mi>C</mi><mo>;</mo><mspace width="10px" />
   <msup>
    <mrow>
     <mover>
      <mrow><mi> &sigma; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo>=</mo><mo>(</mo>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mo>)</mo>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo>;</mo><mspace width="10px" />
   <mover>
    <mrow><mi> &mu; </mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover><mo>=</mo>
   <msup>
    <mrow>
     <mover>
      <mrow><mi> &sigma; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msubsup>
     <mrow><mo> &sum; </mo>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
      </mrow>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msubsup>
    <mfrac>
     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>;</mo><mspace width="20px" /><mi>C</mi><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <mfrac>
    <mrow>
     <mrow><mo>(</mo>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup>
      <mfrac>
       <mrow>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
      <msup>
       <mrow><mo>)</mo>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mfrac><mo>-</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> &sum; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup>
   <mfrac>
    <mrow>
     <msubsup>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
    <mrow>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>
<div class="standard" id='magicparlabel-836'>The joint posterior pdf of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &thetav; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &xi; </mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
      </mrow>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>c</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>a</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>t</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>P</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi>D</mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi> &theta; </mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi> &delta; </mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>P</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>D</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> given obs. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
  </mrow>
 </mrow></math> is<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &thetav; </mi><mo>|</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi> &theta; </mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>c</mi>
         </mrow>
        </msubsup>
       </mrow>
      </msubsup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi>x</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
            </mrow>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>c</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &times; </mo>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>a</mi>
         </mrow>
        </msubsup>
       </mrow>
      </msubsup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
            </mrow>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>a</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>.</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo> &times; </mo>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow>
       <msubsup>
        <mrow><mi>J</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msubsup>
      </mrow>
     </msubsup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow>
        <mrow><mo>(</mo>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
           </mrow>
          </mrow>
         </msub><mo>-</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>-</mo>
         <msub>
          <mrow><mi> &delta; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>-</mo>
         <msub>
          <mrow><mi> &xi; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub>
         <msup>
          <mrow><mo>)</mo>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup>
        </mrow>
       </mrow>
       <mrow>
        <mrow><mn>2</mn>
         <msubsup>
          <mrow><mi> &sigma; </mi>
          </mrow>
          <mrow><mi>t</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msubsup>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow><mo> &times; </mo>
      <msub>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow>
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>=</mo><mn>0</mn>
        </mrow>
       </mrow>
      </msub><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &xi; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi>P</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>P</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <msub>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow>
         <msub>
          <mrow><mi>w</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mo>=</mo><mn>0</mn>
        </mrow>
       </mrow>
      </msub><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &xi; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi>D</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>D</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mspace width="20px" /><mo> &times; </mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>c</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo>
        <msub>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>c</mi>
         </mrow>
        </msubsup><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>a</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo>
        <msub>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>a</mi>
         </mrow>
        </msubsup><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo>
        <msub>
         <mrow><mo> &sum; </mo>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>t</mi>
         </mrow>
        </msubsup><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>I</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mi>I</mi><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>D</mi>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>I</mi>
         </mrow>
         <mrow><mi>D</mi>
         </mrow>
        </msub><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>P</mi>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>I</mi>
         </mrow>
         <mrow><mi>P</mi>
         </mrow>
        </msub><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </msubsup><mn>.</mn>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> The joint posterior&nbsp;distributions is not of standard form, and its pdf is intractable. However the full conditionals are of standard form. For instance, the full conditional posterior distribution density <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo>(</mo>
     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
       </mrow>
      </mrow>
     </msub><mo>|</mo>
     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mrow><mi>a</mi><mi>l</mi><mi>l</mi>
        </mrow>
       </mstyle>
      </mrow>
     </msub><mo>,</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mrow><mi>a</mi><mi>l</mi><mi>l</mi>
        </mrow>
       </mstyle>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mrow><mi>a</mi><mi>l</mi><mi>l</mi>
        </mrow>
       </mstyle>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
       </mrow>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &xi; </mi>
      </mrow>
      <mrow>
       <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
       </mrow>
      </mrow>
     </msub><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>c</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>a</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>t</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>P</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow><mi>D</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mo>,</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi> &delta; </mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>P</mi>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>D</mi>
      </mrow>
     </msub><mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &times; </mo>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>a</mi>
         </mrow>
        </msubsup>
       </mrow>
      </msubsup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi>y</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
            </mrow>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>a</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &times; </mo>
      <msubsup>
       <mrow><mo> &prod; </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi>J</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
         <mrow><mi>t</mi>
         </mrow>
        </msubsup>
       </mrow>
      </msubsup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi>z</mi>
           </mrow>
           <mrow>
            <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
            </mrow>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &xi; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>t</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msub>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
          </msub>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac><mo>-</mo>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow>
         <msubsup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
          <mrow><mi>a</mi>
          </mrow>
         </msubsup>
        </mrow>
       </msubsup>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msub>
            <mrow><mi>y</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
             </mrow>
            </mrow>
           </msub><mo>-</mo>
           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>a</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac><mo>-</mo>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow>
         <msubsup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
          <mrow><mi>t</mi>
          </mrow>
         </msubsup>
        </mrow>
       </msubsup>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msub>
            <mrow><mi>z</mi>
            </mrow>
            <mrow>
             <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
             </mrow>
            </mrow>
           </msub><mo>-</mo>
           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub><mo>-</mo>
           <msub>
            <mrow><mi> &xi; </mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msubsup>
           <mrow><mi> &sigma; </mi>
           </mrow>
           <mrow><mi>t</mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
       </mfrac>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msubsup>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow>
            <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
            </mrow>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msubsup>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msup>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

            <msubsup>
             <mrow><mi> &sigma; </mi>
             </mrow>
             <mrow>
              <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
              </mrow>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
       </mfrac><mo>+</mo>
       <mstyle mathvariant='normal'>
        <mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mn>...</mn>
        </mrow>
       </mstyle>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>
<mspace width="10px" /><mo> &vprop; </mo>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo>-</mo>
       <mfrac>
        <mrow>
         <mrow><mo>(</mo>
          <msub>
           <mrow><mi> &delta; </mi>
           </mrow>
           <mrow><mi>i</mi>
           </mrow>
          </msub><mo>-</mo>
          <msubsup>
           <mrow><mi> &mu; </mi>
           </mrow>
           <mrow>
            <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
            </mrow>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msubsup>
          <msup>
           <mrow><mo>)</mo>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn>
          <msup>
           <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

            <msubsup>
             <mrow><mi> &sigma; </mi>
             </mrow>
             <mrow>
              <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
              </mrow>
             </mrow>
             <mrow><mo>*</mo>
             </mrow>
            </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mrow>
       </mfrac><mo>+</mo>
       <mstyle mathvariant='normal'>
        <mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mn>...</mn>
        </mrow>
       </mstyle>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mo> &vprop; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>I</mi>
      </mrow>
     </msubsup>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msubsup>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
        </mrow>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msubsup><mo>,</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow>
          <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
          </mrow>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math> with <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &delta; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo>|</mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
      </mrow>
     </mstyle><mo>,</mo><mn>...</mn>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mover accent='false'><mo> &sim; </mo>
     <mstyle mathvariant='normal'>
      <mrow><mi>i</mi><mi>n</mi><mi>d</mi>
      </mrow>
     </mstyle></mover>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow>
        <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
        </mrow>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msubsup><mo>,</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow>
          <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
          </mrow>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo><mspace width="6px" /><mi> &forall; </mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow>
       <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
       </mrow>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi> &delta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac><mo>+</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>a</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mi>J</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
       <mrow><mi>a</mi>
       </mrow>
      </msubsup><mo>+</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi> &sigma; </mi>
         </mrow>
         <mrow><mi>t</mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
      <msubsup>
       <mrow><mi>J</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo>;</mo><mspace width="20px" />
   <msubsup>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow>
     <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
     </mrow>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msubsup><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msubsup>
      <mrow><mi> &sigma; </mi>
      </mrow>
      <mrow>
       <mrow><mi> &delta; </mi><mo>,</mo><mi>i</mi>
       </mrow>
      </mrow>
      <mrow><mo>*</mo>
      </mrow>
     </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mfrac>
     <mrow>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac><mo>+</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow>
         <msubsup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
          <mrow><mi>a</mi>
          </mrow>
         </msubsup>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow>
         <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
         </mrow>
        </mrow>
       </msub><mo>-</mo>
       <msubsup>
        <mrow><mi>J</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi>a</mi>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi> &theta; </mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac><mo>+</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mrow><mo> &sum; </mo>
        </mrow>
        <mrow>
         <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
         </mrow>
        </mrow>
        <mrow>
         <msubsup>
          <mrow><mi>J</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
          <mrow><mi>a</mi>
          </mrow>
         </msubsup>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi>y</mi>
        </mrow>
        <mrow>
         <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
         </mrow>
        </mrow>
       </msub><mo>-</mo>
       <msubsup>
        <mrow><mi>J</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi> &theta; </mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>-</mo>
       <msubsup>
        <mrow><mi>J</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
        <mrow><mi>t</mi>
        </mrow>
       </msubsup>
       <msub>
        <mrow><mi> &xi; </mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mfrac>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> Notice that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &delta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> are a postriori independent given all the resp unknown parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &xi; </mi>
    </mrow>
    <mrow>
     <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
     </mrow>
    </mrow>
   </msub><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>c</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>a</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi> &delta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msubsup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mi>D</mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi> &theta; </mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi> &delta; </mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>P</mi>
    </mrow>
   </msub><mo>,</mo>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>D</mi>
    </mrow>
   </msub>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>. Notice that the prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &delta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi> &delta; </mi>
     </mrow>
    </msub><mo>,</mo>
    <msubsup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mi> &delta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msubsup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> in Example <a href="#exa_Robert_and_Reber">13</a> is conditional conjugate prior of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &delta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>.</div>

<div class="standard" id='magicparlabel-851'>Try to compute the rest<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
        </mrow>
       </mrow>
      </msub><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>c</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &xi; </mi>
       </mrow>
       <mrow>
        <mrow><mn>1</mn><mo>:</mo><mi>I</mi>
        </mrow>
       </mrow>
      </msub><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi> &delta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mspace width="6px" /><mo>;</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mi> &pi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &sigma; </mi>
       </mrow>
       <mrow><mi>P</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup><mo>|</mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi>
       </mrow>
      </mstyle><mo>,</mo><mn>...</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo>?</mo><mo>,</mo><mspace width="6px" /><mspace width="6px" /><mspace width="6px" />
     <mstyle mathvariant='normal'>
      <mrow><mi>e</mi><mi>t</mi><mi>c</mi><mn>...</mn>
      </mrow>
     </mstyle>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math></div>

<div class="standard" id='magicparlabel-852'>See the solutions in: Robert, C. P., &amp; Reber, A. (1998) from the link (<span class="flex_url">https://www.jstor.org/stable/pdf/25053027.pdf</span>).</div>
</div>
</body>
</html>
